{"version":3,"sources":["webpack:///./src/js/prototypes/Canvas.js","webpack:///./src/js/prototypes/ModeStore.js","webpack:///./src/js/prototypes/ToolsStore.js","webpack:///./src/js/util/observeAnimatableTree.js","webpack:///./src/js/prototypes/GalleryStore.js","webpack:///./src/js/store.js","webpack:///./src/js/util/storage.js","webpack:///./src/js/index.jsx","webpack:///./src/js/containers/App.jsx","webpack:///./src/js/components/Playbar.jsx","webpack:///./src/js/containers/Viewer.jsx","webpack:///./src/js/util/download.js","webpack:///./src/js/prototypes/Project.js","webpack:///./src/js/containers/Gallery.jsx","webpack:///./src/js/components/GridItem.jsx","webpack:///./src/js/prototypes/Handle.js","webpack:///./src/js/util/string.js","webpack:///./src/js/prototypes/AnimatableItem.js","webpack:///./src/js/prototypes/items/Circle.js","webpack:///./src/js/prototypes/items/Rectangle.js","webpack:///./src/js/prototypes/items/Text.js","webpack:///./src/js/prototypes/items/index.js","webpack:///./src/js/prototypes/Animation.js","webpack:///./src/js/components/Grid.jsx","webpack:///./src/css/index.js","webpack:///./src/js/containers/ToolController.jsx","webpack:///./src/js/components/IntegerInput.jsx","webpack:///./src/js/components/TextInput.jsx","webpack:///./src/js/components/Modal.jsx","webpack:///./src/js/containers/PropertyEditor.jsx","webpack:///./src/js/containers/ProjectSettings.jsx","webpack:///./src/js/containers/ClearProject.jsx","webpack:///./src/js/containers/BuildMode.jsx","webpack:///./src/js/util/bezierApproximation.js","webpack:///./src/js/prototypes/Keyframe.js","webpack:///./src/js/components/Canvas.jsx","webpack:///./src/js/containers/ExportMode.jsx","webpack:///./src/css/bare.min.css","webpack:///./src/js/containers/ModeController.jsx","webpack:///./src/js/prototypes/HandleEditor.js","webpack:///./src/js/containers/HandleEditor.jsx","webpack:///./src/js/containers/KeyframeEditor.jsx","webpack:///./src/js/containers/AnimateMode.jsx","webpack:///./src/js/containers/PlayController.jsx","webpack:///./src/js/components/withWindowSize.jsx","webpack:///./src/js/containers/ViewMode.jsx","webpack:///./node_modules/file-loader/dist/cjs.js"],"names":["Canvas","rootStore","attatchAndSetup","id","element","document","getElementById","paper","setup","view","autoUpdate","background","Path","Rectangle","topLeft","bottomRight","width","height","fillColor","color","draw","animation","firstFrame","addListenersAndSelect","animatable","item","on","handleItemMouseDown","mode","current","handleItemMouseDrag","handleItemMouseUp","select","event","stopPropagation","currentTarget","animatables","name","now","nextPosition","x","relative","position","delta","y","setPropertyAtTime","Math","round","handleViewMouseDown","deselect","forEachAnimatable","callback","Object","values","forEach","build","create","frame","frameToDraw","update","selectOn","isBuildMode","selectOff","off","this","initialize","prevWidth","prevHeight","undefined","_color","tool","selected","setSize","entries","reduce","output","key","toJSON","setSizeAction","action","setTimeout","value","observable","remove","clone","nextTool","entering","toolId","prevTool","exiting","settings","clear","Mode","m","Tools","selectedKeyframe","keyframe","observeAnimatableTree","observableObj","constructor","OBSERVABLES","map","keys","keyframes","keyFrType","Gallery","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","clipsRef","ref","RootStore","reset","project","canvas","tools","PaperScope","Project","Animation","ModeStore","ToolsStore","gallery","GalleryStore","pathArray","window","location","pathname","split","storageEnabled","localStorage","setItem","e","length","projectObj","getItem","load","autorun","projectAsJSON","save","delay","reaction","store","appNode","ReactDOM","render","App","observer","Component","props","minHeight","gridTemplateRows","hot","module","Playbar","fullWidth","totalFrames","inPoint","outPoint","ABSOLUTE_FIRST","playbarWidth","per","marker","head","parseInt","tail","activeHead","activeTail","style","display","playbarStyle","backgroundColor","marginTop","margin","Viewer","canvasHasSize","onSetup","Fragment","hasSize","frames","lastFrame","FIRST","downloadJSON","data","basename","download","filename","type","file","Blob","navigator","msSaveOrOpenBlob","elm","createElement","url","URL","createObjectURL","href","body","appendChild","click","removeChild","revokeObjectURL","setIn","setOut","inputJSON","fileName","input","JSON","parse","setName","replace","inputItems","loadFromFile","targetFile","target","files","reader","FileReader","onload","result","readAsText","stringify","object","publish","push","set","inputBuilt","state","clips","clip","json","buildAnimatables","play","itemKey","itemObj","itemClass","properties","items","add","inputKeyframes","accum","keyframeProp","keyframeList","Keyframe","fromJSON","container","clientWidth","setState","newClip","simpleHash","val","playable","obj","prevState","firstClip","slice","prevProps","prevClipsLen","targetIndex","padding","zIndex","marginBottom","paddingTop","GridItem","children","Handle","influence","distance","_influence","_distance","MAX","newX","newY","titleCase","str","splitStr","toLowerCase","i","charAt","toUpperCase","substring","join","hash","charCodeAt","AnimatableItem","absolute","dimension","fraction","valueForFrame","includes","indexOf","sort","a","b","where","before","after","interpolate","hue","floor","random","saturation","brightness","class","scale","rotation","prop","rotate","property","ignorePairings","valueToKey","k","paired","valueToPair","kP","keyframesPaired","updateKeyframes","filter","keyframesY","setCanvas","sharedProps","onCreate","setUntrackedValues","xKeyframes","yKeyframes","xValue","yValue","activeLayer","_x","_y","_scale","scaleBy","_rotation","rotateBy","_fillColor","X","Y","SCALE","ROTATION","FILL_COLOR","when","existingKeyframe","find","addKey","Circle","radius","itemProps","center","_radius","recreate","RADIUS","absX","absY","absWidth","absHeight","point","size","max","_width","_height","WIDTH","HEIGHT","Text","content","fontSize","PointText","resetPositionFromSizeChange","_content","_fontSize","FONT_SIZE","nextFrame","later","prevFrame","earlier","fps","playing","sync","requestId","f","goToFrame","animateAtRate","pause","cancelAnimationFrame","func","interval","then","Date","loop","requestAnimationFrame","Grid","cssContext","require","ToolController","choose","preventDefault","setTool","addCircle","existing","circle","addRectangle","rect","addText","text","onClick","primary","transform","IntegerInput","localValue","onChange","onBlur","setValue","possibleInt","Number","isInteger","handleKeyDown","shiftKey","incrementBy","decrementBy","changeBy","operation","amount","next","marginRight","textAlign","onKeyDown","TextInput","Modal","open","handleClose","clickawayEl","useRef","onClickaway","contains","PropertyEditor","propertySetter","classControls","left","top","overflow","border","ProjectSettings","setLength","setColor","closeModal","step","flexDirection","ClearProject","justifyContent","BuildMode","ready","inputItemsExist","autorunDisposer","Boolean","prevInputItemsExist","gridTemplateColumns","gridArea","alignSelf","findPointWithLines","points","t","newPoints","currPoint","nextPoint","bezierApproximation","handlePoints","samples","Error","bezierPoints","segments","x2","x3","y2","y3","log10","afterPointIndex","findIndex","lerp","x1","y1","xInterp","handleIn","handleOut","k1","k2","curve","timeRatio","valueRatio","testForAvailability","ExportMode","loadThenBuild","saveThenDownload","justifyItems","htmlFor","exports","ModeController","navigate","textContent","borderBottom","alignItems","HandleEditor","trueWidth","keyframeBefore","keyframeAfter","onMove","attatchTo","handleBefore","absoluteHandlePosition","handleAfter","topRight","bottomLeft","spacing","STEP","gridline","SymbolDefinition","Line","from","to","strokeColor","strokeWidth","offset","place","Point","setVisualCurveHandles","stringStyle","handleBeforeString","handleAfterString","handleMovable","Color","handleStationary","onMouseEnter","cursor","onMouseLeave","onMouseDrag","travelled","subtract","xChange","abs","yChange","xSign","sign","ySign","newPosition","lastSegment","onMouseUp","firstSegment","handlePosition","handleEditor","handleEditorHasSize","buildHandleEditorCanvas","HandleEditorInstance","init","React","keyframeKey","destroy","KeyframeEditor","previouslyClickedKeyframe","keyframeEditorHasSize","buildKeyframeEditorCanvas","handleKeyframeClick","onSelect","shadowColor","alpha","handleKeyUp","removeKey","rebuild","timelineMath","verticalSpacing","timelineStart","timelineEnd","timelineStep","placementIndex","playheadLine","buildPlayhead","newKeyframeItems","list","propName","placing","timelineHover","timeline","newKeyframeRect","visible","newKeyframePlus","newKeyframeHoverEffect","newKeyframeHide","newKeyClick","onMouseMove","hitTest","stroke","keyframeIndex","keyframeRect","shadowBlur","bringToFront","addEventListener","removeEventListener","playheadTriangle","RegularPolygon","sides","timelineWidth","AnimateMode","heWidth","keSize","selectedItemKey","changeHandlePosition","handleType","handleSuffix","kItem","kProp","kIndexStr","kIndex","auxilaryHandle","targetHandle","container2","clientHeight","smallestLength","min","container3","selectKeyframe","keyframesOfType","PlayController","goToNext","goToPrev","goToFirst","goToLast","borderTop","gridColumnStart","getWidth","innerWidth","documentElement","ViewMode","webpackContext","req","webpackContextResolve","__webpack_require__","o","code","webpackContextKeys","resolve"],"mappings":"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","file":"app.427a47c0.js","sourcesContent":["import { observable, action } from 'mobx'\n\nclass Canvas {\n  @observable width\n  @observable height\n  @observable _color\n  @observable background\n  @observable animatables\n  @observable tool\n  @observable selected\n\n  constructor(rootStore) {\n    this.rootStore = rootStore\n    this.paper = rootStore.paper\n    this.initialize()\n  }\n\n  initialize() {\n    let prevWidth\n    let prevHeight\n    if (this.width !== undefined) {\n      prevWidth = this.width\n      prevHeight = this.height\n    }\n\n    this.width = undefined\n    this.height = undefined\n    this._color = '#000000'\n    this.animatables = {}\n    this.tool = undefined\n    this.selected = undefined\n\n    if (prevWidth !== undefined) {\n      this.setSize(prevWidth, prevHeight)\n    }\n  }\n\n  toJSON() {\n    return ({\n      color: this.color,\n      animatables: Object.entries(this.animatables).reduce((output, [key, animatable]) => {\n        output[key] = animatable.toJSON() // eslint-disable-line\n        return output\n      }, {}),\n    })\n  }\n\n  setSize(width, height) {\n    // allows the canvas element one tick to recognize size changes\n    const setSizeAction = action(() => {\n      this.height = height\n      this.width = width\n    })\n    setTimeout(setSizeAction, 1)\n  }\n\n  attatchAndSetup = (id) => {\n    const element = document.getElementById(id)\n    this.paper.setup(element)\n    this.paper.view.autoUpdate = false\n    this.background = new this.paper.Path.Rectangle({\n      topLeft: [0, 0],\n      bottomRight: [this.paper.view.element.width, this.paper.view.element.height],\n      fillColor: this.color,\n    })\n    this.draw(this.rootStore.animation.firstFrame)\n  }\n\n  get color() { return this._color }\n  set color(value) {\n    this._color = value\n    this.background.fillColor = value\n  }\n\n  @action add = (animatable) => {\n    animatable.create(this)\n    this.animatables = {\n      ...this.animatables,\n      [animatable.key]: animatable,\n    }\n\n    if (this.tool === 'SELECT') {\n      this.addListenersAndSelect(animatable)\n    }\n\n    this.draw()\n  }\n\n  @action remove = (animatable) => {\n    animatable.item.off('mousedown', this.handleItemMouseDown)\n    animatable.item.off('mousedrag', this.handleItemMouseDrag)\n    animatable.item.off('mouseup', this.handleItemMouseUp)\n    animatable.item.remove()\n\n    const clone = { ...this.animatables }\n    delete clone[animatable.key]\n    this.animatables = clone\n    this.draw()\n  }\n\n  @action setTool = (nextTool) => {\n    const prevTool = this.tool\n\n    const entering = toolId => (prevTool !== toolId && nextTool === toolId)\n    const exiting = toolId => (prevTool === toolId && nextTool !== toolId)\n\n    if (entering('SELECT')) { this.selectOn() }\n    if (exiting('SELECT')) { this.selectOff() }\n\n    if (entering('SETTINGS')) { this.rootStore.mode.settings = true }\n    if (exiting('SETTINGS')) { this.rootStore.mode.settings = false }\n\n    if (entering('CLEAR')) { this.rootStore.mode.clear = true }\n    if (exiting('CLEAR')) { this.rootStore.mode.clear = false }\n\n    // Finally, set the tool in-memory\n    this.tool = nextTool\n  }\n\n  @action select = (item) => {\n    this.deselect()\n    item.selected = true // eslint-disable-line no-param-reassign\n    this.selected = this.animatables[item.name]\n    this.paper.view.update()\n  }\n\n  @action deselect = () => {\n    if (this.selected) {\n      this.selected.item.selected = false\n      this.selected = undefined\n    }\n    this.paper.view.update()\n  }\n\n  addListenersAndSelect = (animatable) => {\n    animatable.item.on('mousedown', this.handleItemMouseDown)\n    if (this.rootStore.mode.current === 'BUILD') {\n      animatable.item.on('mousedrag', this.handleItemMouseDrag)\n      animatable.item.on('mouseup', this.handleItemMouseUp)\n    }\n    this.select(animatable.item)\n  }\n\n  handleItemMouseDown = (event) => {\n    event.stopPropagation()\n    this.select(event.currentTarget)\n  }\n\n  handleItemMouseDrag = (event) => {\n    event.stopPropagation()\n    const item = event.currentTarget\n    const animatable = this.animatables[item.name]\n    const { now } = this.rootStore.animation\n    const nextPosition = {\n      x: animatable.relative(item.position.x + event.delta.x),\n      y: animatable.relative(item.position.y + event.delta.y, 'height'),\n    }\n    animatable.setPropertyAtTime('x', nextPosition.x, now)\n    animatable.setPropertyAtTime('y', nextPosition.y, now)\n  }\n\n  handleItemMouseUp = (event) => {\n    event.stopPropagation()\n    const item = event.currentTarget\n    const animatable = this.animatables[item.name]\n    const { now } = this.rootStore.animation\n    const nextPosition = {\n      x: Math.round(animatable.x),\n      y: Math.round(animatable.y),\n    }\n    if (nextPosition.x !== animatable.x || nextPosition.y !== animatable.y) {\n      // prevents adding new keyframes when simply clicking an item\n      animatable.setPropertyAtTime('x', nextPosition.x, now)\n      animatable.setPropertyAtTime('y', nextPosition.y, now)\n    }\n  }\n\n  handleViewMouseDown = (event) => {\n    event.stopPropagation()\n    this.deselect()\n  }\n\n  forEachAnimatable = callback => (\n    Object.values(this.animatables).forEach(callback)\n  )\n\n  build = () => {\n    this.forEachAnimatable((animatable) => { animatable.create(this) })\n    this.draw()\n  }\n\n  draw = (frame) => {\n    const frameToDraw = frame || this.rootStore.animation.now\n    this.forEachAnimatable((animatable) => { animatable.draw(frameToDraw) })\n    if (this.paper.view) this.paper.view.update()\n  }\n\n  selectOn = () => {\n    const isBuildMode = this.rootStore.mode.current === 'BUILD'\n    this.forEachAnimatable((animatable) => {\n      animatable.item.on('mousedown', this.handleItemMouseDown)\n      if (isBuildMode) {\n        animatable.item.on('mousedrag', this.handleItemMouseDrag)\n        animatable.item.on('mouseup', this.handleItemMouseUp)\n      }\n    })\n    this.paper.view.on('mousedown', this.handleViewMouseDown)\n  }\n\n  selectOff = () => {\n    const isBuildMode = this.rootStore.mode.current === 'BUILD'\n    this.forEachAnimatable((animatable) => {\n      animatable.item.off('mousedown', this.handleItemMouseDown)\n      if (isBuildMode) {\n        animatable.item.off('mousedrag', this.handleItemMouseDrag)\n        animatable.item.off('mouseup', this.handleItemMouseUp)\n      }\n    })\n    this.paper.view.off('mousedown', this.handleViewMouseDown)\n    this.deselect()\n  }\n}\n\nexport default Canvas\n","import { observable, action } from 'mobx'\n\nclass Mode {\n  @observable current\n  @observable settings\n  @observable clear\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.current = 'BUILD'\n    this.settings = false\n    this.clear = false\n  }\n\n  @action set = (m) => {\n    this.current = m\n  }\n}\n\nexport default Mode\n","import { observable, action } from 'mobx'\n\nclass Tools {\n  @observable selectedKeyframe\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.selectedKeyframe = undefined\n  }\n\n  @action selectKeyframe = (keyframe) => {\n    this.selectedKeyframe = keyframe\n  }\n}\n\nexport default Tools\n","const observeAnimatableTree = (observableObj) => {\n  const observableKeys = observableObj.constructor.OBSERVABLES\n  return observableKeys.map((key) => {\n    if (key === 'keyframes') {\n      return Object.keys(observableObj.keyframes).map(keyFrType => (\n        observableObj.keyframes[keyFrType].map(observeAnimatableTree)\n      ))\n    }\n\n    const value = observableObj[key]\n    if (value.constructor.OBSERVABLES) {\n      return observeAnimatableTree(value)\n    }\n\n    return value\n  })\n}\n\nexport default observeAnimatableTree\n","import { observable } from 'mobx'\n\nimport * as firebase from 'firebase/app'\nimport 'firebase/database'\n\nclass Gallery {\n  @observable clipsRef\n\n  constructor() {\n    firebase.initializeApp({\n      apiKey: 'AIzaSyCdglP4EAub1kYXJrXag3vaNIxxQgEZTQk',\n      authDomain: 'micro-graph.firebaseapp.com',\n      databaseURL: 'https://micro-graph.firebaseio.com',\n      projectId: 'micro-graph',\n      storageBucket: 'micro-graph.appspot.com',\n      messagingSenderId: '662102370030',\n      appId: '1:662102370030:web:46cfe6a252ed6cc47b75ff',\n    })\n\n    this.clipsRef = firebase.database().ref('clips')\n  }\n}\n\nexport default Gallery\n","import { observable, reaction, autorun } from 'mobx'\nimport paper from 'paper'\n\nimport Project from './prototypes/Project'\nimport Canvas from './prototypes/Canvas'\nimport Animation from './prototypes/Animation'\nimport ModeStore from './prototypes/ModeStore'\nimport ToolsStore from './prototypes/ToolsStore'\nimport GalleryStore from './prototypes/GalleryStore'\n\nimport observeAnimatableTree from './util/observeAnimatableTree'\nimport { storageEnabled } from './util/storage'\n\nclass RootStore {\n  @observable project\n  @observable canvas\n  @observable animation\n  @observable mode\n  @observable tools\n  @observable gallery\n\n  constructor() {\n    this.paper = new paper.PaperScope()\n\n    this.project = new Project(this)\n    this.canvas = new Canvas(this)\n    this.animation = new Animation()\n    this.mode = new ModeStore()\n    this.tools = new ToolsStore()\n    this.gallery = new GalleryStore()\n\n    // Auto Save & Auto Load\n    const { pathname } = window.location\n    const pathArray = pathname.split('/')\n\n    if (\n      storageEnabled() &&\n      (pathArray.length > 1 && pathArray[1] !== 'gallery')\n    ) {\n      const projectObj = localStorage.getItem('micrograph.project')\n      if (projectObj) {\n        setTimeout(() => {\n          this.project.load(projectObj)\n        }, 100)\n      }\n\n      autorun(() => {\n        const projectAsJSON = this.project.save()\n        localStorage.setItem('micrograph.project', projectAsJSON)\n      }, { delay: 300 })\n    }\n\n    // Reacts to all changes made to animatable item properties and redraws the canvas\n    reaction(\n      () => ([\n        this.animation.now,\n        this.canvas.color,\n        Object.values(this.canvas.animatables).map(observeAnimatableTree),\n      ]),\n      () => this.canvas.draw()\n    )\n  }\n\n  reset = () => {\n    this.project.initialize()\n    this.canvas.initialize()\n    this.animation.initialize()\n    this.mode.initialize()\n    this.tools.initialize()\n  }\n}\n\nexport default RootStore\n","const storageEnabled = () => {\n  try {\n    localStorage.setItem('_test', 'test')\n  } catch (e) {\n    return false\n  }\n  return true\n}\n\nconst storageSet = (key, value) => {\n  localStorage.setItem(key, JSON.stringify(value))\n}\n\nconst storageGet = (key) => {\n  const value = localStorage.getItem(key)\n  return value && JSON.parse(value)\n}\n\nexport {\n  storageEnabled,\n  storageSet,\n  storageGet,\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\n// Root Application Container\nimport App from './containers/App'\nimport RootStore from './store'\n\n// Styles\nimport '../css'\n\nconst store = new RootStore()\nconst appNode = document.getElementById('app')\n\nReactDOM.render(\n  <App store={store} />,\n  appNode\n)\n","import React, { Component } from 'react'\nimport { hot } from 'react-hot-loader'\nimport { observer } from 'mobx-react'\n\nimport ModeController from './ModeController'\nimport BuildMode from './BuildMode'\nimport AnimateMode from './AnimateMode'\nimport ViewMode from './ViewMode'\nimport ExportMode from './ExportMode'\nimport Gallery from './Gallery'\nimport Grid from '../components/Grid'\n\n@observer\nclass App extends Component {\n  componentDidMount() {\n    // const { store } = this.props\n    // store.canvas.setTool('SETTINGS')\n  }\n\n  render() {\n    const { store } = this.props\n    const { pathname } = window.location\n\n    const pathArray = pathname.split('/')\n    if (pathArray.length > 1 && pathArray[1] === 'gallery') {\n      return <Gallery clipsRef={store.gallery.clipsRef} />\n    }\n\n    return (\n      <Grid\n        minHeight=\"100vh\"\n        gridTemplateRows=\"60px 1fr\"\n      >\n        <ModeController mode={store.mode} />\n        {store.mode.current === 'BUILD' &&\n          <BuildMode store={store} />\n        }\n        {store.mode.current === 'ANIMATE' &&\n          <AnimateMode store={store} />\n        }\n        {store.mode.current === 'VIEW' &&\n          <ViewMode store={store} />\n        }\n        {store.mode.current === 'EXPORT' &&\n          <ExportMode store={store} />\n        }\n      </Grid>\n    )\n  }\n}\n\nexport default hot(module)(App)\n","import React from 'react'\n\nconst playbarStyle = { height: '10px', margin: '10px 0px' }\n\nconst Playbar = ({\n  fullWidth,\n  totalFrames,\n  inPoint,\n  outPoint,\n  now,\n  ABSOLUTE_FIRST,\n}) => {\n  const playbarWidth = fullWidth || 0\n\n  const per = playbarWidth / totalFrames\n  const marker = totalFrames > 1 ? per : 0\n  const head = parseInt((inPoint - ABSOLUTE_FIRST) * per)\n  const tail = parseInt((totalFrames - outPoint) * per)\n\n  let activeHead = parseInt((now * per) - head)\n  if (totalFrames === 1) {\n    activeHead = per\n  } else if (now === inPoint) {\n    activeHead = 0\n  } else if (now === outPoint) {\n    activeHead = playbarWidth - head - tail - marker\n  }\n  const activeTail = now === outPoint ? 0 : playbarWidth - head - tail - activeHead - marker\n\n  return (\n    <div style={{ display: 'flex' }}>\n      <div style={{\n        ...playbarStyle,\n        width: head,\n        backgroundColor: 'rgb(150, 160, 170)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: activeHead,\n        backgroundColor: 'rgb(220, 225, 240)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: marker,\n        height: '20px',\n        marginTop: '5px',\n        backgroundColor: 'rgb(30, 155, 255)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: activeTail,\n        backgroundColor: 'rgb(220, 225, 240)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: tail,\n        backgroundColor: 'rgb(150, 160, 170)' }}\n      />\n    </div>\n  )\n}\n\nexport default Playbar\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Animation from '../prototypes/Animation'\nimport Canvas from '../components/Canvas'\nimport Playbar from '../components/Playbar'\n\n@observer\nclass Viewer extends Component {\n  canvasHasSize = () => {\n    const { canvas, onSetup } = this.props\n    canvas.attatchAndSetup('paper-canvas')\n    onSetup()\n  }\n\n  render() {\n    const { canvas, animation } = this.props\n    return (\n      <React.Fragment>\n        <Canvas\n          id=\"paper-canvas\"\n          width={canvas.width}\n          height={canvas.height}\n          hasSize={this.canvasHasSize}\n        />\n        <Playbar\n          fullWidth={canvas.width}\n          totalFrames={animation.frames}\n          inPoint={animation.firstFrame}\n          outPoint={animation.lastFrame}\n          now={animation.now}\n          ABSOLUTE_FIRST={Animation.FIRST}\n        />\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Viewer\n","const download = (data, filename, type) => {\n  const file = new Blob([data], { type })\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveOrOpenBlob(file, filename)\n  } else {\n    const elm = document.createElement('a')\n    const url = window.URL.createObjectURL(file)\n\n    elm.href = url\n    elm.download = filename\n\n    document.body.appendChild(elm)\n    elm.click()\n\n    setTimeout(() => {\n      document.body.removeChild(elm)\n      window.URL.revokeObjectURL(url)\n    })\n  }\n}\n\nconst downloadJSON = (data, basename) => (\n  download(data, `${basename}.json`, 'text/json')\n)\n\nexport {\n  download,\n  downloadJSON,\n}\n","import { observable, action } from 'mobx'\n\nimport Animation from './Animation'\nimport { downloadJSON } from '../util/download'\n\nclass Project {\n  @observable name\n  @observable inputItems\n  @observable inputBuilt\n\n  constructor(rootStore) {\n    this.rootStore = rootStore\n    this.paper = rootStore.paper\n    this.initialize()\n  }\n\n  initialize() {\n    if (this.paper.project) {\n      this.paper.project.clear()\n      this.paper.project.remove()\n    }\n    this.name = 'My Animation'\n    this.inputItems = undefined\n    this.inputBuilt = false\n  }\n\n  toJSON() {\n    return ({\n      name: this.name,\n    })\n  }\n\n  @action setName(name) {\n    this.name = name\n  }\n\n  clear = () => {\n    this.paper.project.clear()\n    this.paper.project.remove()\n\n    const { canvas, animation } = this.rootStore\n    canvas.setSize(undefined, undefined)\n    animation.setIn(Animation.FIRST)\n    animation.setOut(animation.frames)\n  }\n\n  load = (inputJSON, fileName, callback) => {\n    const { canvas, animation } = this.rootStore\n    const input = JSON.parse(inputJSON)\n\n    const name = fileName || input.project.name\n    this.setName(name.replace(/\\.[^/.]+$/, ''))\n\n    Object.keys(input.animation).forEach((key) => {\n      animation[key] = input.animation[key]\n    })\n\n    Object.keys(input.canvas).forEach((key) => {\n      if (key === 'animatables') {\n        this.inputItems = input.canvas.animatables\n      } else {\n        canvas[key] = input.canvas[key]\n      }\n    })\n\n    if (callback) callback()\n  }\n\n  loadFromFile = (event, callback) => {\n    const { files } = event.target\n    const targetFile = files[0]\n    const reader = new FileReader()\n    reader.onload = () => this.load(reader.result, targetFile.name, callback)\n\n    this.rootStore.reset()\n    reader.readAsText(targetFile)\n  }\n\n  save = () => {\n    /* eslint no-param-reassign: 0 */\n    const { canvas, animation } = this.rootStore\n    const projectAsJSON = JSON.stringify({\n      project: this.toJSON(),\n      animation: animation.toJSON(),\n      canvas: canvas.toJSON(),\n    })\n    return projectAsJSON\n  }\n\n  download = (object) => {\n    downloadJSON(object, this.name)\n  }\n\n  publish = () => {\n    const projectAsJSON = this.save()\n    this.rootStore.gallery.clipsRef.push().set(projectAsJSON)\n  }\n\n  // render() {\n  //   // render canvas animation to frames\n  // }\n}\n\nexport default Project\n","import React, { Component } from 'react'\nimport { reaction } from 'mobx'\nimport { observer } from 'mobx-react'\nimport paper from 'paper'\n\nimport CanvasEl from '../components/Canvas'\n\nimport Project from '../prototypes/Project'\nimport Canvas from '../prototypes/Canvas'\nimport Animation from '../prototypes/Animation'\nimport Keyframe from '../prototypes/Keyframe'\nimport items from '../prototypes/items'\n\nimport { simpleHash } from '../util/string'\n\nconst playable = () => {\n  const obj = {}\n  obj.paper = new paper.PaperScope()\n  obj.project = new Project(obj)\n  obj.canvas = new Canvas(obj)\n  obj.animation = new Animation()\n  return obj\n}\n\n@observer\nclass Gallery extends Component {\n  state = {\n    clips: [],\n    width: undefined,\n    height: undefined,\n  }\n\n  componentDidMount() {\n    const container = document.getElementById('playback-container')\n    const width = Math.round(container.clientWidth) - 20\n    const height = Math.round((9 / 16) * width)\n    this.setState({ width, height })\n\n\n    const { clipsRef } = this.props\n    clipsRef.on('child_added', (data) => {\n      const newClip = {\n        key: `${simpleHash(data.val())}`,\n        json: data.val(),\n        clip: playable(),\n      }\n\n      this.setState((prevState) => {\n        const firstClip = prevState.clips[0]\n        if (firstClip) {\n          return ({\n            clips: [\n              firstClip,\n              newClip,\n              ...prevState.clips.slice(1),\n            ],\n          })\n        }\n        return ({ clips: [newClip] })\n      })\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { width, height, clips } = this.state\n    const prevClipsLen = prevState.clips.length\n    if (clips.length > prevClipsLen) {\n      const targetIndex = prevClipsLen === 0 ? 0 : 1\n      clips[targetIndex].clip.canvas.setSize(width, height)\n      reaction(\n        () => ([\n          clips[targetIndex].clip.animation.now,\n        ]),\n        () => clips[targetIndex].clip.canvas.draw()\n      )\n    }\n  }\n\n  canvasHasSize = (key, clip, json) => () => {\n    clip.canvas.attatchAndSetup(`paper-canvas-${key}`)\n    clip.canvas.build()\n    clip.project.load(json)\n    this.buildAnimatables(clip)\n    clip.animation.play()\n  }\n\n  buildAnimatables = (clip) => {\n    Object.entries(clip.project.inputItems).forEach(([itemKey, itemObj]) => {\n      const { class: itemClass, keyframes, ...properties } = itemObj\n\n      const animatable = new items[itemClass](itemKey)\n      clip.canvas.add(animatable)\n\n      const inputKeyframes = Object.entries(keyframes)\n        .reduce((accum, [keyframeProp, keyframeList]) => {\n          /* eslint no-param-reassign: 0 */\n          accum[keyframeProp] = keyframeList.map(Keyframe.fromJSON)\n          return accum\n        }, {})\n      animatable.keyframes = {\n        ...this.keyframes,\n        ...inputKeyframes,\n      }\n\n      Object.entries(properties).forEach(([key, value]) => {\n        animatable[key] = value\n      })\n    })\n\n    clip.canvas.deselect()\n    clip.canvas.draw()\n  }\n\n  render() {\n    const { clips } = this.state\n\n    return (\n      <div>\n        <div style={{ width: '100%', padding: '10px', position: 'fixed', backgroundColor: 'white', zIndex: '100' }}>\n          <h1 style={{ marginBottom: '0px' }}>Welcome to the Gallery</h1>\n          <small>{clips.length} Published Animations, scroll to see them!</small>\n        </div>\n\n        <div id=\"playback-container\" style={{ width: '100%', padding: '0px 10px', paddingTop: '100px' }}>\n          {clips.length === 0 ? (\n            <p>Loading Clips...</p>\n          ) : (\n            clips.map(({ clip, key, json }) => (\n              <div key={key} style={{ padding: '10px 0px' }}>\n                <h4 style={{ marginBottom: '4px' }}>{clip.project.name}</h4>\n                <CanvasEl\n                  id={`paper-canvas-${key}`}\n                  width={clip.canvas.width}\n                  height={clip.canvas.height}\n                  hasSize={this.canvasHasSize(key, clip, json)}\n                />\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Gallery\n","import React from 'react'\n\nconst GridItem = ({ id, children, ...style }) => (\n  <div id={id} style={style}>\n    {children}\n  </div>\n)\n\nexport default GridItem\n","import { observable } from 'mobx'\n\nclass Handle {\n  static get MAX() { return 100 }\n  static get STEP() { return 10 }\n  static get OBSERVABLES() {\n    return ['influence', 'distance']\n  }\n\n  @observable _influence\n  @observable _distance\n\n  constructor(type) {\n    this.type = type\n    this.influence = 50\n    this.distance = 0\n  }\n\n  toJSON() {\n    return ({\n      type: this.type,\n      influence: this.influence,\n      distance: this.distance,\n    })\n  }\n\n  get influence() { return this._influence }\n  get distance() { return this._distance }\n  get position() {\n    let x = this.influence\n    let y = this.distance\n    if (this.type === 'IN') {\n      x = Handle.MAX - this.influence\n      y = Handle.MAX - this.distance\n    }\n    x /= Handle.MAX\n    y /= Handle.MAX\n    return { x, y }\n  }\n\n  set influence(value) {\n    this._influence = value\n  }\n\n  set distance(value) {\n    this._distance = value\n  }\n\n  set position({ x, y }) {\n    const newX = x * Handle.MAX\n    const newY = x * Handle.MAX\n    if (this.type === 'IN') {\n      this.influence = Handle.MAX - newX\n      this.distance = Handle.MAX - newY\n    } else {\n      this.influence = newX\n      this.distance = newY\n    }\n  }\n}\n\nexport default Handle\n","const titleCase = (str) => {\n  /* Convert `any string` into `Any String`, including replacing underscores\n    with spaces */\n  const splitStr = str.toLowerCase().split(/[\\s_]+/)\n  for (let i = 0; i < splitStr.length; i += 1) {\n    splitStr[i] = splitStr[i].charAt(0).toUpperCase() + splitStr[i].substring(1)\n  }\n  return splitStr.join(' ')\n}\n\nconst simpleHash = (str) => {\n  /* eslint no-bitwise: 0 */\n  let hash = 0\n  if (str.length === 0) return hash\n\n  for (let i = 0; i < str.length; i += 1) {\n    const char = str.charCodeAt(i)\n    hash = ((hash << 5) - hash) + char\n    hash &= hash\n  }\n\n  return hash\n}\n\nexport {\n  titleCase,\n  simpleHash,\n}\n","import { observable, action } from 'mobx'\n\nimport Keyframe from './Keyframe'\n\nclass AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get X() { return 50 }\n  static get Y() { return 50 }\n\n  // Absolute Values\n  static get SCALE() { return 100 }\n  static get ROTATION() { return 0 }\n  static get FILL_COLOR() {\n    return {\n      hue: Math.floor(Math.random() * 361),\n      saturation: 0.4,\n      brightness: 1,\n    }\n  }\n\n  static get OBSERVABLES() {\n    return ['x', 'y', 'scale', 'rotation', 'fillColor', 'keyframes']\n  }\n\n  constructor(key) {\n    this.key = key\n    this.paper = undefined\n  }\n\n  @observable canvas\n  @observable _x = AnimatableItem.X\n  @observable _y = AnimatableItem.Y\n  @observable _scale = AnimatableItem.SCALE\n  @observable _rotation = AnimatableItem.ROTATION\n  @observable _fillColor = AnimatableItem.FILL_COLOR\n  @observable keyframes = {\n    x: observable([]),\n    y: observable([]),\n    scale: observable([]),\n    rotation: observable([]),\n  }\n\n  toJSON() {\n    return ({\n      class: this.constructor.name,\n      x: this.x,\n      y: this.y,\n      scale: this.scale,\n      rotation: this.rotation,\n      fillColor: this.fillColor,\n      keyframes: Object.entries(this.keyframes).reduce(\n        (output, [prop, keyframeList]) => {\n          /* eslint no-param-reassign: 0 */\n          output[prop] = keyframeList.map(keyframe => keyframe.toJSON())\n          return output\n        }, {}\n      ),\n    })\n  }\n\n  get item() { return this.paper.project.activeLayer.children[this.key] }\n  get x() { return this._x }\n  get y() { return this._y }\n  get position() { return { x: this.x, y: this.y } }\n  get scale() { return this._scale }\n  get rotation() { return this._rotation }\n  get fillColor() { return this._fillColor }\n\n  set x(value) {\n    this.item.position.x = this.absolute(value)\n    this._x = value\n  }\n\n  set y(value) {\n    this.item.position.y = this.absolute(value, 'height')\n    this._y = value\n  }\n\n  set position({ x, y }) {\n    this.x = x\n    this.y = y\n  }\n\n  set scale(value) {\n    if (this.scale === 0 && value !== 0) {\n      this.item.remove()\n      this.create(this.canvas)\n      this.item.scale(this.fraction(value))\n    } else {\n      const scaleBy = value / this.scale\n      this.item.scale(scaleBy)\n    }\n    this._scale = value\n  }\n\n  set rotation(value) {\n    const rotateBy = value - this.rotation\n    this.item.rotate(rotateBy)\n    this._rotation = value\n  }\n\n  set fillColor(value) {\n    this.item.fillColor = value\n    this._fillColor = value\n  }\n\n  @action setCanvas(canvas) {\n    this.canvas = canvas\n    this.paper = canvas.paper\n  }\n\n  @action setUntrackedValues() {\n    this.item.scale(this.fraction(this.scale))\n    this.item.rotate(this.rotation)\n  }\n\n  @action setPropertyAtTime = (property, value, when) => {\n    if (this.keyframes[property] && this.keyframes[property].length) {\n      const existingKeyframe = this.keyframes[property].find(keyframe => keyframe.frame === when)\n      if (existingKeyframe) {\n        existingKeyframe.value = value\n      } else {\n        this.addKey(`${property}`, when, value)\n      }\n    } else {\n      this[property] = value\n    }\n  }\n\n  @action updateKeyframes(property, keyframes) {\n    this.keyframes = {\n      ...this.keyframes,\n      [property]: keyframes,\n    }\n  }\n\n  addKey(property, frame, value = undefined, ignorePairings = false) {\n    const valueToKey = value || this[property]\n    const k = new Keyframe(frame, valueToKey)\n    const keyframes = [...this.keyframes[property], k]\n    keyframes.sort(Keyframe.sort)\n\n    if (!ignorePairings && ['x', 'y'].includes(property)) {\n      let paired\n      if (property === 'x') { paired = 'y' }\n      if (property === 'y') { paired = 'x' }\n\n      const valueToPair = this[paired]\n      const kP = new Keyframe(frame, valueToPair)\n      const keyframesPaired = [...this.keyframes[paired], kP]\n      keyframesPaired.sort(Keyframe.sort)\n\n      this.keyframes = {\n        ...this.keyframes,\n        [property]: keyframes,\n        [paired]: keyframesPaired,\n      }\n    } else {\n      this.updateKeyframes(property, keyframes)\n    }\n\n    return k\n  }\n\n  removeKey(property, frame) {\n    let keyframes = [...this.keyframes[property]]\n    keyframes = keyframes.filter(k => k.frame !== frame)\n\n    if (property === 'x') {\n      let keyframesY = [...this.keyframes.y]\n      keyframesY = keyframesY.filter(k => k.frame !== frame)\n      this.keyframes = {\n        ...this.keyframes,\n        x: keyframes,\n        y: keyframesY,\n      }\n    } else {\n      this.updateKeyframes(property, keyframes)\n    }\n  }\n\n  absolute = (value, dimension = 'width') => (\n    (value / 100) * this.canvas[dimension]\n  )\n\n  relative = (value, dimension = 'width') => (\n    (value * 100) / this.canvas[dimension]\n  )\n\n  fraction = value => (\n    value / 100\n  )\n\n  create(canvas) {\n    if (this.canvas === undefined) this.setCanvas(canvas)\n\n    const sharedProps = {\n      name: this.key,\n      fillColor: this.fillColor,\n    }\n\n    if (typeof this.onCreate === 'function') {\n      this.onCreate(sharedProps)\n    }\n\n    if (this.item !== undefined) this.setUntrackedValues()\n  }\n\n  recreate() {\n    this.item.remove()\n    this.create(this.canvas)\n    this.canvas.addListenersAndSelect(this)\n  }\n\n  draw(frame) {\n    if (this.item === undefined) return\n\n    Object.entries(this.keyframes).forEach(([property, keyframes]) => {\n      // Ignore `y` property\n      if (property === 'y') return\n      if (property === 'x') {\n        // Interpret `x` & `y` at the same time\n        const xKeyframes = keyframes\n        const yKeyframes = this.keyframes.y\n        if (xKeyframes.length === 0 && yKeyframes.length === 0) return\n        const xValue = this.valueForFrame(frame, xKeyframes)\n        const yValue = this.valueForFrame(frame, yKeyframes)\n        this.position = { x: xValue, y: yValue }\n      } else {\n        // Interpret all other properties individually\n        if (keyframes.length === 0) return\n        const value = this.valueForFrame(frame, keyframes)\n        this[property] = value\n      }\n    })\n  }\n\n  valueForFrame = (frame, keyframes) => {\n    const frames = keyframes.map(key => key.frame)\n\n    // is frame a keyframe\n    if (frames.includes(frame)) {\n      const where = frames.indexOf(frame)\n      return keyframes[where].value\n    }\n\n    // where is frame with respect to keyframes\n    frames.push(frame)\n    frames.sort((a, b) => a - b)\n    const where = frames.indexOf(frame)\n\n    // is frame before or after last key\n    if (where === 0) return keyframes[0].value\n    if (where === frames.length - 1) return keyframes[keyframes.length - 1].value\n\n    // frame is between two keys\n    const before = keyframes[where - 1]\n    const after = keyframes[where]\n    return Keyframe.interpolate(before, after, frame)\n  }\n}\n\nexport default AnimatableItem\n","import { observable } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Circle extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get RADIUS() { return 10 }\n\n  @observable _radius = Circle.RADIUS\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      radius: this.radius,\n    })\n  }\n\n  get radius() { return this._radius }\n  set radius(value) {\n    // TODO: update this value using item.bounds and scale\n    this._radius = value\n    this.recreate()\n  }\n\n  onCreate(itemProps) {\n    const { x, y } = this.position\n    new this.paper.Path.Circle({\n      ...itemProps,\n      center: [this.absolute(x), this.absolute(y, 'height')],\n      radius: this.absolute(this.radius) / 2,\n    })\n  }\n}\n\nexport default Circle\n","import { observable } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Rectangle extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get WIDTH() { return 10 }\n  static get HEIGHT() { return 10 }\n  static get RADIUS() { return 0 }\n\n  @observable _width = Rectangle.WIDTH\n  @observable _height = Rectangle.HEIGHT\n  @observable _radius = Rectangle.RADIUS\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      width: this.width,\n      height: this.height,\n      radius: this.radius,\n    })\n  }\n\n  get width() { return this._width }\n  get height() { return this._height }\n  get radius() { return this._radius }\n\n  set width(value) {\n    // TODO: update this value using item.bounds and scale\n    this._width = value\n    this.recreate()\n  }\n\n  set height(value) {\n    // TODO: update this value using item.bounds and scale\n    this._height = value\n    this.recreate()\n  }\n\n  set radius(value) {\n    // TODO: update this value using item.bounds and scale\n    this._radius = value\n    this.recreate()\n  }\n\n  onCreate(itemProps) {\n    const { x, y } = this.position\n    const absX = this.absolute(x)\n    const absY = this.absolute(y, 'height')\n    const absWidth = this.absolute(this.width)\n    const absHeight = this.absolute(this.height)\n\n    new this.paper.Path.Rectangle({\n      ...itemProps,\n      point: [absX - (absWidth / 2), absY - (absHeight / 2)],\n      size: [absWidth, absHeight],\n      radius: (this.radius / 100) * (Math.max(absWidth, absHeight) / 2),\n    })\n  }\n}\n\nexport default Rectangle\n","import { observable, action } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Text extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get FONT_SIZE() { return 20 }\n\n  static get OBSERVABLES() {\n    return [...AnimatableItem.OBSERVABLES, 'fontSize']\n  }\n\n  @observable _content = 'Text Object'\n  @observable _fontSize = Text.FONT_SIZE\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      content: this.content,\n      fontSize: this.fontSize,\n    })\n  }\n\n  get content() { return this._content }\n  get fontSize() { return this._fontSize }\n\n  set content(value) {\n    this.item.content = value\n    this._content = value\n    this.resetPositionFromSizeChange()\n  }\n\n  set fontSize(value) {\n    this.item.fontSize = this.absolute(value) / 5\n    this._fontSize = value\n    this.resetPositionFromSizeChange()\n  }\n\n  @action resetPositionFromSizeChange() {\n    const { x, y } = this.position\n    this.position = { x, y }\n    this.canvas.draw()\n  }\n\n  onCreate(itemProps) {\n    new this.paper.PointText({\n      ...itemProps,\n      content: this.content,\n    })\n    this.fontSize = this.fontSize // placed here to eliminate duplicate logic\n    this.resetPositionFromSizeChange()\n  }\n}\n\nexport default Text\n","import Circle from './Circle'\nimport Rectangle from './Rectangle'\nimport Text from './Text'\n\nconst items = {\n  Circle,\n  Rectangle,\n  Text,\n}\n\nexport default items\n","import { observable, action } from 'mobx'\n\nclass Animation {\n  static get FIRST() { return 1 }\n  static get PLAYBACK_MODES() { return ['LOOP', 'ONCE'] }\n\n  @observable frames\n  @observable firstFrame\n  @observable lastFrame\n  @observable fps\n  @observable now\n  @observable playing\n  @observable sync\n  @observable requestId\n  @observable mode\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.frames = 100\n    this.firstFrame = Animation.FIRST\n    this.lastFrame = 100\n    this.fps = 30\n    this.now = this.firstFrame\n    this.playing = false\n    this.sync = 0\n    this.requestId = null\n    this.mode = 'LOOP'\n  }\n\n  toJSON() {\n    return ({\n      frames: this.frames,\n      firstFrame: this.firstFrame,\n      lastFrame: this.lastFrame,\n      fps: this.fps,\n      mode: this.mode,\n    })\n  }\n\n  @action setLength(length) {\n    this.frames = length\n    if (length < this.lastFrame) {\n      this.lastFrame = length\n    }\n  }\n\n  @action setIn = (f) => {\n    if (f < Animation.FIRST || f > this.frames) return\n    this.firstFrame = f\n    if (this.now < f) {\n      this.goToFrame(f)\n    }\n  }\n\n  @action setOut = (f) => {\n    if (f < Animation.FIRST || f > this.frames) return\n    this.lastFrame = f\n    if (this.now > f) {\n      this.goToFrame(f)\n    }\n  }\n\n  nextFrame = () => {\n    const later = this.now + 1\n    if (later > this.lastFrame) {\n      if (this.mode === 'LOOP') return this.firstFrame\n      return null\n    }\n    return later\n  }\n\n  prevFrame = () => {\n    const earlier = this.now - 1\n    if (earlier < this.firstFrame) {\n      if (this.mode === 'LOOP') return this.lastFrame\n      return null\n    }\n    return earlier\n  }\n\n  @action play = () => {\n    if (this.nextFrame() === null) return\n    this.playing = true\n    this.animateAtRate(() => {\n      const nextFrame = this.nextFrame()\n      if (nextFrame === null) return this.pause()\n      this.now = nextFrame\n    })\n  }\n\n  @action pause = () => {\n    this.playing = false\n    if (this.requestId) cancelAnimationFrame(this.requestId)\n  }\n\n  @action goToFrame = (frame) => {\n    this.now = frame\n  }\n\n  @action goToFirst = () => {\n    this.goToFrame(this.firstFrame)\n  }\n\n  @action goToLast = () => {\n    this.goToFrame(this.lastFrame)\n  }\n\n  @action goToNext = () => {\n    const nextFrame = this.nextFrame()\n    if (nextFrame === null) return\n    this.goToFrame(nextFrame)\n  }\n\n  @action goToPrev = () => {\n    const prevFrame = this.prevFrame()\n    if (prevFrame === null) return\n    this.goToFrame(prevFrame)\n  }\n\n  @action animateAtRate = (func) => {\n    const interval = 1000 / this.fps\n    let then = Date.now()\n\n    const loop = () => {\n      if (this.playing === false) return\n      this.requestId = requestAnimationFrame(loop)\n      const now = Date.now()\n      const delta = now - then\n      if (delta >= interval) {\n        then = now - (delta % interval)\n        this.sync = Math.round(delta - interval - (delta % interval))\n        func()\n      }\n    }\n    loop()\n  }\n}\n\nexport default Animation\n","import React from 'react'\n\nconst Grid = ({ children, ...style }) => (\n  <div style={{ display: 'grid', ...style }}>\n    {children}\n  </div>\n)\n\nexport default Grid\n","const cssContext = require.context(\n  '!!file-loader?name=[name].[ext]!.',\n  true,\n  /\\.(css)$/\n)\n\ncssContext.keys().forEach(cssContext)\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport items from '../prototypes/items'\n\n@observer\nclass ToolController extends Component {\n  choose = (event) => {\n    event.preventDefault()\n    this.props.setTool(event.currentTarget.id)\n  }\n\n  addCircle = () => {\n    const { existing } = this.props\n    const circle = new items.Circle(`circle-${Object.keys(existing).length}`)\n    this.props.add(circle)\n  }\n\n  addRectangle = () => {\n    const { existing } = this.props\n    const rect = new items.Rectangle(`rect-${Object.keys(existing).length}`)\n    this.props.add(rect)\n  }\n\n  addText = () => {\n    const { existing } = this.props\n    const text = new items.Text(`text-${Object.keys(existing).length}`)\n    this.props.add(text)\n  }\n\n  render() {\n    const { tool } = this.props\n\n    return (\n      <div style={{ display: 'flex', padding: '10px 10px 0px 10px' }}>\n        <button\n          type=\"button\"\n          id=\"SETTINGS\"\n          onClick={this.choose}\n          {...(tool === 'SETTINGS' ? { primary: 'true' } : {})}\n        >\n          <div>&#9776;</div>\n        </button>\n        <button\n          type=\"button\"\n          id=\"CLEAR\"\n          onClick={this.choose}\n        >\n          <div>&#10007;</div>\n        </button>\n        <button\n          type=\"button\"\n          id=\"SELECT\"\n          onClick={this.choose}\n          {...(tool === 'SELECT' ? { primary: 'true' } : {})}\n        >\n          <div style={{ transform: 'rotate(-135deg)' }}>&#10148;</div>\n        </button>\n        {/* <button\n          type=\"button\"\n          id=\"DRAW\"\n          onClick={this.choose}\n          {...(tool === 'DRAW' ? { primary: 'true' } : {})}\n        >\n          \n        </button> */}\n\n        <button type=\"button\" onClick={this.addCircle}>+ Circle</button>\n        <button type=\"button\" onClick={this.addRectangle}>+ Rectangle</button>\n        <button type=\"button\" onClick={this.addText}>+ Text</button>\n      </div>\n    )\n  }\n}\n\nexport default ToolController\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass IntegerInput extends Component {\n  state = {\n    localValue: 0,\n  }\n\n  componentDidMount() {\n    const { value } = this.props\n    if (value !== this.state.localValue) {\n      this.setState({ localValue: value })\n    }\n  }\n\n  onChange = (event) => {\n    this.setState({ localValue: event.target.value })\n  }\n\n  onBlur = () => {\n    const { value, setValue } = this.props\n    const { localValue } = this.state\n\n    const possibleInt = parseInt(localValue)\n    let result = value\n    if (Number.isInteger(possibleInt)) {\n      result = possibleInt\n    }\n\n    setValue(result)\n    this.setState({ localValue: result })\n  }\n\n  handleKeyDown = (event) => {\n    const { key, shiftKey } = event\n    if (key === 'ArrowUp' && shiftKey) {\n      this.incrementBy(10)\n    } else if (key === 'ArrowUp') {\n      this.incrementBy(1)\n    } else if (key === 'ArrowDown' && shiftKey) {\n      this.decrementBy(10)\n    } else if (key === 'ArrowDown') {\n      this.decrementBy(1)\n    }\n  }\n\n  changeBy = operation => (amount) => {\n    const { value, setValue } = this.props\n    const next = operation(value, amount)\n    setValue(next)\n    this.setState({ localValue: next })\n  }\n\n  // eslint-disable-next-line\n  incrementBy = this.changeBy((a, b) => a + b)\n  decrementBy = this.changeBy((a, b) => a - b)\n\n  render() {\n    const { localValue } = this.state\n    return (\n      <input\n        type=\"text\"\n        style={{ width: '60px', marginRight: '20px', textAlign: 'center' }}\n        value={localValue}\n        onChange={this.onChange}\n        onKeyDown={this.handleKeyDown}\n        onBlur={this.onBlur}\n      />\n    )\n  }\n}\n\nexport default IntegerInput\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass TextInput extends Component {\n  onChange = (event) => {\n    const { setValue } = this.props\n    setValue(event.target.value)\n  }\n\n  render() {\n    const { value } = this.props\n    return (\n      <input\n        type=\"text\"\n        style={{ width: '100%', marginRight: '20px', textAlign: 'left' }}\n        value={value}\n        onChange={this.onChange}\n      />\n    )\n  }\n}\n\nexport default TextInput\n","import React, { useRef } from 'react'\n\nconst style = {\n  container: {\n    position: 'fixed',\n    zIndex: 100,\n    left: 0,\n    top: 0,\n    width: '100%',\n    height: '100%',\n    overflow: 'auto',\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n  },\n  body: {\n    backgroundColor: '#fefefe',\n    margin: '15% auto',\n    border: '1px solid #888',\n    width: '80%',\n  },\n  content: {\n    padding: '16px',\n  },\n}\n\nconst Modal = ({ children, open, handleClose }) => {\n  const clickawayEl = useRef(null)\n\n  const onClickaway = (event) => {\n    if (clickawayEl.current.contains(event.target)) return\n    handleClose()\n  }\n\n  return (\n    open === false ? null : (\n      <div style={style.container} onClick={onClickaway}>\n        <div ref={clickawayEl} style={style.body}>\n          <div style={style.content}>{children}</div>\n        </div>\n      </div>\n    )\n  )\n}\n\nexport default Modal\n","// encapsulates ValueEditor, implements editing the paper properties of an AnimatibleItem\n\nimport React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport IntegerInput from '../components/IntegerInput'\nimport TextInput from '../components/TextInput'\n\n@observer\nclass PropertyEditor extends Component {\n  propertySetter = (property) => {\n    const { item, now } = this.props\n    return value => item.setPropertyAtTime(property, value, now)\n  }\n\n  classControls() {\n    const { item } = this.props\n    const itemClass = item.constructor.name\n\n    if (itemClass === 'Circle') {\n      return (\n        <React.Fragment>\n          <label>Radius</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.radius} setValue={this.propertySetter('radius')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n\n    if (itemClass === 'Rectangle') {\n      return (\n        <React.Fragment>\n          <label>Size</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.width} setValue={this.propertySetter('width')} />\n            <IntegerInput value={item.height} setValue={this.propertySetter('height')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n\n    if (itemClass === 'Text') {\n      return (\n        <React.Fragment>\n          <label>Content</label>\n          <div style={{ display: 'flex' }}>\n            <TextInput value={item.content} setValue={this.propertySetter('content')} />\n          </div>\n          <label>Font Size</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.fontSize} setValue={this.propertySetter('fontSize')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n  }\n\n  render() {\n    const { item } = this.props\n\n    if (item === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          Select an Item on the Canvas.\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <h4>{item.key}</h4>\n        <label>Position</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.x} setValue={this.propertySetter('x')} />\n          <IntegerInput value={item.y} setValue={this.propertySetter('y')} />\n        </div>\n\n        <label>Scale</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.scale} setValue={this.propertySetter('scale')} />\n        </div>\n\n        <label>Rotation</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.rotation} setValue={this.propertySetter('rotation')} />\n        </div>\n\n        {this.classControls()}\n      </div>\n    )\n  }\n}\n\nexport default PropertyEditor\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Modal from '../components/Modal'\n\n@observer\nclass ProjectSettings extends Component {\n  setName = (event) => {\n    const { store } = this.props\n    store.project.setName(event.target.value)\n  }\n\n  setLength = (event) => {\n    const { store } = this.props\n    const length = parseInt(event.target.value)\n    store.animation.setLength(length)\n  }\n\n  setColor = (event) => {\n    const { store } = this.props\n    store.canvas.color = event.target.value\n  }\n\n  closeModal = () => this.props.store.canvas.setTool('SELECT')\n\n  render() {\n    const { store } = this.props\n\n    return (\n      <Modal open={store.mode.settings} handleClose={this.closeModal}>\n        <h3>Project Settings</h3>\n\n        <label>Project Name</label>\n        <input type=\"text\" value={store.project.name} onChange={this.setName} />\n\n        <label>Animation Length</label>\n        <input type=\"number\" step=\"1\" value={store.animation.frames} onChange={this.setLength} />\n\n        <label>Canvas Background</label>\n        <select value={store.canvas.color} onChange={this.setColor}>\n          <option value=\"#000000\">Black</option>\n          <option value=\"#ffffff\">White</option>\n        </select>\n\n        <div style={{ display: 'flex', flexDirection: 'row-reverse' }}>\n          <button type=\"button\" onClick={this.closeModal}>Close</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default ProjectSettings\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Modal from '../components/Modal'\n\n@observer\nclass ClearProject extends Component {\n  closeModal = () => this.props.store.canvas.setTool('SELECT')\n\n  render() {\n    const { store } = this.props\n    const { mode, project, reset } = store\n\n    return (\n      <Modal open={mode.clear} handleClose={this.closeModal}>\n        <h3>Remove Project?</h3>\n\n        <p>\n          You are about to remove&nbsp;\n          <strong>{project.name}</strong>\n          &nbsp;from your workspace, and start from scratch.\n          Are you sure you want to do this?\n        </p>\n\n        <div style={{ display: 'flex', justifyContent: 'flex-end' }}>\n          <button type=\"button\" onClick={this.closeModal}>Cancel</button>\n          <button type=\"button\" onClick={reset}>Remove</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default ClearProject\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\nimport { autorun } from 'mobx'\n\nimport Viewer from './Viewer'\nimport ToolController from './ToolController'\nimport PropertyEditor from './PropertyEditor'\nimport ProjectSettings from './ProjectSettings'\nimport ClearProject from './ClearProject'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nimport items from '../prototypes/items'\nimport Keyframe from '../prototypes/Keyframe'\n\n@observer\nclass BuildMode extends Component {\n  state = {\n    ready: false,\n    inputItemsExist: false,\n  }\n\n  autorunDisposer\n\n  componentDidMount() {\n    const { canvas, project } = this.props.store\n    const container = document.getElementById('build-container')\n    setTimeout(() => {\n      const width = Math.round(container.clientWidth) - 20\n      const height = Math.round((9 / 16) * width)\n      canvas.setSize(width, height)\n    }, 1)\n\n    if (canvas.tool === 'SELECT') {\n      setTimeout(() => {\n        canvas.setTool(undefined)\n        canvas.setTool('SELECT')\n      }, 20)\n    }\n\n    this.autorunDisposer = autorun(() => {\n      this.setState({ inputItemsExist: Boolean(project.inputItems) })\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const prevInputItemsExist = prevState.inputItemsExist\n    const { canvas, project } = this.props.store\n    const { ready, inputItemsExist } = this.state\n    if (\n      !project.inputBuilt &&\n      (\n        (ready && !prevInputItemsExist && inputItemsExist) ||\n        (inputItemsExist && !prevState.ready && ready)\n      )\n    ) {\n      Object.entries(project.inputItems).forEach(([itemKey, itemObj]) => {\n        const { class: itemClass, keyframes, ...properties } = itemObj\n\n        const animatable = new items[itemClass](itemKey)\n        canvas.add(animatable)\n\n        const inputKeyframes = Object.entries(keyframes)\n          .reduce((accum, [keyframeProp, keyframeList]) => {\n            /* eslint no-param-reassign: 0 */\n            accum[keyframeProp] = keyframeList.map(Keyframe.fromJSON)\n            return accum\n          }, {})\n        animatable.keyframes = {\n          ...this.keyframes,\n          ...inputKeyframes,\n        }\n\n        Object.entries(properties).forEach(([key, value]) => {\n          animatable[key] = value\n        })\n      })\n\n      project.inputBuilt = true\n    }\n  }\n\n  componentWillUnmount() {\n    const { project, canvas } = this.props.store\n    canvas.selectOff()\n    project.clear()\n    this.autorunDisposer()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n    this.setState({ ready: true })\n  }\n\n  add = (item) => {\n    const { canvas } = this.props.store\n    canvas.add(item)\n  }\n\n  render() {\n    const { canvas, animation } = this.props.store\n    const { ready } = this.state\n    return (\n      <React.Fragment>\n        <ProjectSettings store={this.props.store} />\n        <ClearProject store={this.props.store} />\n        <Grid\n          gridTemplateRows=\"auto 60px\"\n          gridTemplateColumns=\"auto 340px\"\n        >\n          <GridItem gridArea=\"1 / 1 / 1 / 2\" id=\"build-container\" padding=\"10px\" alignSelf=\"center\">\n            <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n          </GridItem>\n          <GridItem gridArea=\"1 / 2 / 1 / 3\" backgroundColor=\"rgb(210, 210, 210)\">\n            <PropertyEditor item={canvas.selected} now={animation.now} />\n          </GridItem>\n          <GridItem gridArea=\"2 / 1 / 2 / 3\" backgroundColor=\"rgb(180, 180, 180)\">\n            { ready && (\n              <ToolController\n                existing={canvas.animatables}\n                add={this.add}\n                tool={canvas.tool}\n                setTool={canvas.setTool}\n              />\n            )}\n          </GridItem>\n        </Grid>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default BuildMode\n","const findPointWithLines = (points, t) => {\n  if (points.length === 1) {\n    return points[0]\n  }\n\n  const newPoints = []\n  for (let i = 0; i < points.length - 1; i += 1) {\n    const currPoint = points[i]\n    const nextPoint = points[i + 1]\n\n    const x = (1 - t) * currPoint.x + t * nextPoint.x\n    const y = (1 - t) * currPoint.y + t * nextPoint.y\n\n    newPoints.push({ x, y })\n  }\n\n  return findPointWithLines(newPoints, t)\n}\n\nconst bezierPoints = ({ x2, x3, y2, y3 }, segments) => {\n  /* x2, and x3 are the X values from the 2nd and 3rd points for a bezier\n      definition. For this use case, they must be between 0 - 1.\n  */\n  if (x2 > 1 || x2 < 0 || x3 > 1 || x3 < 0) {\n    throw Error('This bezier curve requires control values between 0 & 1')\n  }\n\n  const points = []\n  const step = 1 / segments\n\n  for (let i = 0; i <= segments; i += 1) {\n    const time = i * step\n    const point = findPointWithLines([\n      { x: 0, y: 0 },\n      { x: x2, y: y2 },\n      { x: x3, y: y3 },\n      { x: 1, y: 1 },\n    ], time)\n\n    points.push(point)\n  }\n\n  return points\n}\n\nconst lerp = (x1, y1, x2, y2, xInterp) => (\n  (((xInterp - x1) * (y2 - y1)) / (x2 - x1)) + y1\n)\n\nconst bezierApproximation = (handlePoints, samples) => {\n  if (samples <= 0) {\n    throw Error('Bezier approximation requires at least 1 sample request')\n  }\n\n  const granularity = 10 ** (Math.round(Math.log10(samples)) + 1)\n  const points = bezierPoints(handlePoints, granularity)\n\n  const y = (x) => {\n    const afterPointIndex = points.findIndex(point => point.x > x)\n    const before = points[afterPointIndex - 1]\n    const after = points[afterPointIndex]\n    return lerp(before.x, before.y, after.x, after.y, x)\n  }\n\n  return { y }\n}\n\nexport default bezierApproximation\n","import { observable } from 'mobx'\n\nimport Handle from './Handle'\nimport bezierApproximation from '../util/bezierApproximation'\n\nclass Keyframe {\n  static get OBSERVABLES() {\n    return ['frame', 'value', 'handleIn', 'handleOut']\n  }\n\n  @observable frame\n  @observable value\n  @observable handleIn\n  @observable handleOut\n\n  constructor(frame, value) {\n    this.frame = frame\n    this.value = value\n    this.handleIn = new Handle('IN')\n    this.handleOut = new Handle('OUT')\n  }\n\n  toJSON() {\n    return ({\n      frame: this.frame,\n      value: this.value,\n      handleIn: this.handleIn.toJSON(),\n      handleOut: this.handleOut.toJSON(),\n    })\n  }\n\n  static fromJSON(input) {\n    const { frame, value, handleIn, handleOut } = input\n    const keyframe = new Keyframe(frame, value)\n    keyframe.handleIn.influence = handleIn.influence\n    keyframe.handleIn.distance = handleIn.distance\n    keyframe.handleOut.influence = handleOut.influence\n    keyframe.handleOut.distance = handleOut.distance\n    return keyframe\n  }\n\n  static sort = (a, b) => (a.frame - b.frame)\n\n  static interpolate = (k1, k2, frame) => {\n    // TODO: cache the curve creation to reduce computation\n    const curve = bezierApproximation(\n      {\n        x2: k1.handleOut.position.x,\n        y2: k1.handleOut.position.y,\n        x3: k2.handleIn.position.x,\n        y3: k2.handleIn.position.y,\n      },\n      k2.frame - k1.frame - 1\n    )\n\n    const timeRatio = (frame - k1.frame) / (k2.frame - k1.frame)\n    const valueRatio = curve.y(timeRatio)\n    const interpolated = ((k2.value - k1.value) * valueRatio) + k1.value\n\n    return interpolated\n  }\n}\n\nexport default Keyframe\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass Canvas extends Component {\n  componentDidMount() {\n    this.testForAvailability()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.width === undefined) {\n      this.testForAvailability()\n    }\n  }\n\n  testForAvailability() {\n    const { width, hasSize } = this.props\n    if (width !== undefined) {\n      hasSize()\n    }\n  }\n\n  render() {\n    const { id, width, height } = this.props\n    if (width === undefined) return null\n    return (\n      <canvas\n        style={{ display: 'block' }}\n        id={id}\n        width={width}\n        height={height}\n      />\n    )\n  }\n}\n\nexport default Canvas\n","/* encapsulates Mode, implements:\n\n  | Viewer     | ExportEditor   |\n  |            |                |\n   ------------|                |\n  | Format     |                |\n  | Controller |                |\n\n*/\n\nimport React, { Component } from 'react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nclass ExportMode extends Component {\n  loadThenBuild = (event) => {\n    const { project, mode } = this.props.store\n    return project.loadFromFile(event, () => mode.set('BUILD'))\n  }\n\n  saveThenDownload = () => {\n    const { project } = this.props.store\n    project.download(project.save())\n  }\n\n  render() {\n    const { project } = this.props.store\n\n    return (\n      <Grid\n        gridTemplateRows=\"1fr 1fr 1fr\"\n        gridTemplateColumns=\"auto\"\n        // alignItems=\"center\"\n        justifyItems=\"center\"\n      >\n        {/* <GridItem padding=\"10px\">\n          <h3 style={{ padding: '10px', color: 'darkgray' }}>\n            Feature under construction.\n          </h3>\n        </GridItem> */}\n        <GridItem alignSelf=\"end\">\n          <button type=\"button\" onClick={this.saveThenDownload}>&#x21e9; Save Project to File</button>\n        </GridItem>\n        <GridItem alignSelf=\"center\">\n          <label htmlFor=\"file-button\" style={{ display: 'block', width: '300px' }}>&#x21aa; Load Project from File</label>\n          <input type=\"file\" id=\"file-button\" onChange={this.loadThenBuild} style={{ width: '300px' }} />\n        </GridItem>\n        <GridItem>\n          <button type=\"button\" onClick={project.publish}>&#x2912; Publish Project to Gallery</button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default ExportMode\n","module.exports = __webpack_public_path__ + \"bare.min.css\";","import React, { Component } from 'react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nclass ModeController extends Component {\n  navigate = (event) => {\n    event.preventDefault()\n    const { mode } = this.props\n    mode.set(event.target.textContent.toUpperCase())\n  }\n\n  render() {\n    const { current } = this.props.mode\n    return (\n      <Grid gridTemplateColumns=\"1fr 1fr 1fr 1fr\" borderBottom=\"1px solid rgb(230, 230, 230)\">\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'BUILD' ? { primary: 'true' } : {})}\n          >\n            Build\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'ANIMATE' ? { primary: 'true' } : {})}\n          >\n            Animate\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'VIEW' ? { primary: 'true' } : {})}\n          >\n            View\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'EXPORT' ? { primary: 'true' } : {})}\n          >\n            Export\n          </button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default ModeController\n","import paper from 'paper'\n\nimport Handle from './Handle'\n\nclass HandleEditor {\n  constructor(trueWidth, keyframeBefore, keyframeAfter, onMove) {\n    this.trueWidth = trueWidth\n    this.keyframeBefore = keyframeBefore\n    this.keyframeAfter = keyframeAfter\n    this.onMove = onMove\n    this.paper = new paper.PaperScope()\n\n    this.element = undefined\n  }\n\n  attatchTo = (id) => {\n    const element = document.getElementById(id)\n    this.element = element\n    this.paper.setup(element)\n  }\n\n  destroy() {\n    if (this.paper.project) {\n      this.paper.project.clear()\n      this.paper.project.remove()\n    }\n  }\n\n  init() {\n    // Assumes Width & Height are identical\n    this.padding = 10\n    this.width = this.trueWidth - (this.padding * 2)\n    const { width, padding } = this\n\n    const topLeft = [padding, padding]\n    const topRight = [width + padding, padding]\n    const bottomLeft = [padding, width + padding]\n    // const bottomRight = [width, width + padding]\n    const spacing = width / Handle.STEP\n    const center = this.trueWidth / 2\n\n    // Background\n    new this.paper.Path.Rectangle({\n      topLeft: [0, 0],\n      bottomRight: [this.trueWidth, this.trueWidth],\n      fillColor: 'rgb(210, 210, 210)',\n    })\n\n    // Gridlines\n    const gridline = new this.paper.SymbolDefinition(\n      new this.paper.Path.Line({\n        from: [0, 0],\n        to: [0, this.trueWidth],\n        // strokeColor: '#324252',\n        strokeColor: 'rgb(180, 180, 180)',\n        strokeWidth: 2,\n      })\n    )\n    for (let i = 0; i <= Handle.STEP; i += 1) {\n      const offset = padding + 0 + (spacing * i)\n      gridline.place(new this.paper.Point(offset, center))\n      const offAxis = gridline.place(new this.paper.Point(center, offset))\n      offAxis.rotate(90)\n    }\n\n    // Value Interpolation Curve\n    this.curve = new this.paper.Path.Line({\n      // strokeColor: '#2176ff',\n      strokeColor: 'rgb(30, 155, 255)',\n      strokeWidth: 2,\n      from: new this.paper.Point(bottomLeft),\n      to: new this.paper.Point(topRight),\n    })\n    this.setVisualCurveHandles()\n\n    // Handle Strings\n    const stringStyle = {\n      // strokeColor: '#2176ff',\n      strokeColor: 'rgb(30, 155, 255)',\n      strokeWidth: 2,\n    }\n    const handleBeforeString = new this.paper.Path.Line({\n      ...stringStyle,\n      from: bottomLeft,\n      to: this.handleBefore(),\n    })\n    const handleAfterString = new this.paper.Path.Line({\n      ...stringStyle,\n      from: this.handleAfter(),\n      to: topRight,\n    })\n\n    // Handle Grips\n    const handleMovable = new this.paper.SymbolDefinition(\n      new this.paper.Path.Circle({\n        point: topLeft,\n        radius: 6,\n        // strokeColor: '#2176ff',\n        strokeColor: 'rgb(30, 155, 255)',\n        strokeWidth: 2,\n        fillColor: new this.paper.Color(1, 0.01),\n      })\n    )\n    const handleStationary = new this.paper.SymbolDefinition(\n      new this.paper.Path.Rectangle({\n        point: [100, 100],\n        size: [10, 10],\n        // fillColor: '#2176ff',\n        fillColor: 'rgb(30, 155, 255)',\n      })\n    )\n    handleStationary.place(bottomLeft)\n    handleStationary.place(topRight)\n    const handleBefore = handleMovable.place(this.handleBefore())\n    const handleAfter = handleMovable.place(this.handleAfter())\n\n    // Handle Events\n    handleBefore.onMouseEnter = () => {\n      this.element.style.cursor = 'pointer'\n    }\n    handleBefore.onMouseLeave = () => {\n      this.element.style.cursor = 'default'\n    }\n    handleBefore.onMouseDrag = (event) => {\n      this.element.style.cursor = 'pointer'\n      const travelled = event.point.subtract(handleBefore.position)\n\n      const xChange = Math.abs(travelled.x) >= (spacing / 2)\n      const yChange = Math.abs(travelled.y) >= (spacing / 2)\n      if (xChange || yChange) {\n        const xSign = Math.sign(travelled.x)\n        const ySign = Math.sign(travelled.y)\n        const newPosition = handleBefore.position.add({\n          x: xSign * spacing * xChange,\n          y: ySign * spacing * yChange,\n        })\n\n        handleBefore.position = newPosition\n        handleBeforeString.lastSegment.point = newPosition\n        this.onMove('OUT', {\n          influence: xSign * Handle.STEP * xChange,\n          distance: -1 * ySign * Handle.STEP * yChange,\n        })\n        this.setVisualCurveHandles()\n      }\n    }\n    handleBefore.onMouseUp = () => {\n      this.element.style.cursor = 'default'\n    }\n\n    handleAfter.onMouseEnter = () => {\n      this.element.style.cursor = 'pointer'\n    }\n    handleAfter.onMouseLeave = () => {\n      this.element.style.cursor = 'default'\n    }\n    handleAfter.onMouseDrag = (event) => {\n      this.element.style.cursor = 'pointer'\n      const travelled = event.point.subtract(handleAfter.position)\n\n      const xChange = Math.abs(travelled.x) >= (spacing / 2)\n      const yChange = Math.abs(travelled.y) >= (spacing / 2)\n      if (xChange || yChange) {\n        const xSign = Math.sign(travelled.x)\n        const ySign = Math.sign(travelled.y)\n        const newPosition = handleAfter.position.add({\n          x: xSign * spacing * xChange,\n          y: ySign * spacing * yChange,\n        })\n\n        handleAfter.position = newPosition\n        handleAfterString.firstSegment.point = newPosition\n        this.onMove('IN', {\n          influence: -1 * xSign * Handle.STEP * xChange,\n          distance: ySign * Handle.STEP * yChange,\n        })\n        this.setVisualCurveHandles()\n      }\n    }\n    handleAfter.onMouseUp = () => {\n      this.element.style.cursor = 'default'\n    }\n  }\n\n\n  handleBefore = () => (\n    this.absoluteHandlePosition(this.keyframeBefore.handleOut.position)\n  )\n\n  handleAfter = () => (\n    this.absoluteHandlePosition(this.keyframeAfter.handleIn.position)\n  )\n\n  absoluteHandlePosition(handlePosition) {\n    return ([\n      handlePosition.x * this.width + this.padding,\n      // Compensates for 4th quadrant cartesian system\n      this.width - (handlePosition.y * this.width) + this.padding,\n    ])\n  }\n\n  setVisualCurveHandles() {\n    if (this.curve) {\n      this.curve.firstSegment.handleOut = new this.paper.Point(\n        this.keyframeBefore.handleOut.influence * this.width / Handle.MAX,\n        -1 * this.keyframeBefore.handleOut.distance * this.width / Handle.MAX\n      )\n      this.curve.lastSegment.handleIn = new this.paper.Point(\n        -1 * this.keyframeAfter.handleIn.influence * this.width / Handle.MAX,\n        this.keyframeAfter.handleIn.distance * this.width / Handle.MAX\n      )\n    }\n  }\n}\n\nexport default HandleEditor\n","import React from 'react'\nimport { observer } from 'mobx-react'\n\nimport Canvas from '../components/Canvas'\n\nimport HandleEditorInstance from '../prototypes/HandleEditor'\n\n@observer\nclass HandleEditor extends React.Component {\n  state = {}\n\n  handleEditor\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.keyframeKey !== undefined && prevProps.keyframeKey !== this.props.keyframeKey) {\n      if (this.handleEditor) this.handleEditor.destroy()\n      this.buildHandleEditorCanvas()\n    }\n  }\n\n  handleEditorHasSize = () => {\n    this.buildHandleEditorCanvas()\n  }\n\n  buildHandleEditorCanvas = () => {\n    const { width, keyframeBefore, keyframeAfter, onMove } = this.props\n\n    if (keyframeBefore && keyframeAfter) {\n      this.handleEditor = new HandleEditorInstance(width, keyframeBefore, keyframeAfter, onMove)\n      this.handleEditor.attatchTo('handle-editor')\n      this.handleEditor.init()\n    }\n  }\n\n  render() {\n    const { width, keyframeKey, keyframeBefore, keyframeAfter } = this.props\n\n    if (keyframeKey === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          Select a Keyframe on the Timeline.\n        </h3>\n      )\n    }\n\n    if (keyframeBefore && !keyframeAfter) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          <i>Selected tail Keyframe has no handle relationships.</i>\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <Canvas\n          id=\"handle-editor\"\n          width={width}\n          height={width}\n          hasSize={this.handleEditorHasSize}\n        />\n      </div>\n    )\n  }\n}\n\nexport default HandleEditor\n","import React from 'react'\nimport { observer } from 'mobx-react'\nimport paper from 'paper'\n\nimport Canvas from '../components/Canvas'\n\n@observer\nclass KeyframeEditor extends React.Component {\n  state = {\n    previouslyClickedKeyframe: undefined,\n  }\n\n  paper = new paper.PaperScope()\n  element\n\n  componentDidMount() {\n    document.addEventListener('keyup', this.handleKeyUp)\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.item !== undefined &&\n      this.props.item !== undefined &&\n      prevProps.item.key !== this.props.item.key\n    ) {\n      this.rebuild()\n    }\n\n    if (prevProps.now !== this.props.now) {\n      this.buildPlayhead()\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keyup', this.handleKeyUp)\n  }\n\n  keyframeEditorHasSize = () => {\n    this.buildKeyframeEditorCanvas()\n  }\n\n  handleKeyframeClick = (event) => {\n    event.stopPropagation()\n    const { currentTarget } = event\n\n    const { onSelect } = this.props\n    const { previouslyClickedKeyframe } = this.state\n\n    if (previouslyClickedKeyframe) {\n      previouslyClickedKeyframe.strokeWidth = 0\n      previouslyClickedKeyframe.shadowColor.alpha = 0\n    }\n    currentTarget.strokeWidth = 1\n    currentTarget.shadowColor.alpha = 0.3\n    onSelect(currentTarget.name)\n    this.setState({ previouslyClickedKeyframe: currentTarget })\n  }\n\n  handleKeyUp = (event) => {\n    const { key } = event\n    const { item, keyframeKey, keyframe, onSelect } = this.props\n    if (key === 'Backspace' || key === 'Delete') {\n      event.preventDefault()\n\n      const keyframeProp = keyframeKey.split('.')[1]\n      onSelect(undefined)\n      item.removeKey(keyframeProp, keyframe.frame)\n      this.rebuild()\n    }\n  }\n\n  buildKeyframeEditorCanvas = () => {\n    const { item } = this.props\n    this.element = document.getElementById('keyframe-editor')\n    this.paper.setup(this.element)\n\n    const { verticalSpacing, timelineStart, timelineEnd, timelineStep } = this.timelineMath()\n    let placementIndex = 0\n\n    const { playheadLine } = this.buildPlayhead()\n    const newKeyframeItems = []\n\n    Object.entries(item.keyframes).forEach(([prop, list]) => {\n      let propName = prop\n      const placing = placementIndex * verticalSpacing + verticalSpacing\n\n      if (prop === 'y') return // Interpret `x` & `y` at the same time\n      if (prop === 'x') {\n        propName = 'position'\n      }\n\n      // Draw Timelines\n      new this.paper.PointText({\n        point: [0, placing],\n        content: propName,\n        fillColor: 'black',\n        fontSize: 14,\n      })\n      const timelineHover = new this.paper.Path.Line({\n        name: 'timelineHover',\n        from: [timelineStart + 5, placing - 5],\n        to: [timelineEnd, placing - 5],\n        strokeColor: 'rgba(180, 180, 180, 1)',\n        strokeWidth: 40,\n      })\n      const timeline = new this.paper.Path.Line({\n        from: [timelineStart + 5, placing - 5],\n        to: [timelineEnd, placing - 5],\n        strokeColor: 'lightgrey',\n        strokeWidth: 4,\n      })\n\n      const newKeyframeRect = new this.paper.Path.Rectangle({\n        name: 'newKeyframeRect',\n        point: [0, placing - 10],\n        size: [10, 10],\n        radius: 3,\n        fillColor: 'rgba(31, 155, 255, 0.5)',\n        rotation: 45,\n        visible: false,\n      })\n      const newKeyframePlus = new this.paper.PointText({\n        point: [0, placing - 8],\n        content: '+',\n        fillColor: 'rgba(31, 155, 255, 0.5)',\n        fontSize: 14,\n        visible: false,\n      })\n\n      newKeyframeItems.push([timelineHover, newKeyframeRect, newKeyframePlus])\n\n      // TODO: Put these all in a group, including the playheadsegment, and apply one event\n      const newKeyframeHoverEffect = (event) => {\n        newKeyframeRect.visible = true\n        newKeyframePlus.visible = true\n        newKeyframeRect.position.x = event.point.x\n        newKeyframePlus.position.x = event.point.x + 10\n      }\n      const newKeyframeHide = () => {\n        newKeyframeRect.visible = false\n        newKeyframePlus.visible = false\n      }\n      const newKeyClick = (event) => {\n        const frame = Math.round((event.point.x - timelineStart) / timelineStep)\n        item.addKey(prop, frame)\n        this.rebuild()\n      }\n\n      timelineHover.onMouseMove = newKeyframeHoverEffect\n      timelineHover.onMouseLeave = newKeyframeHide\n      timeline.onMouseMove = newKeyframeHoverEffect\n      timeline.onMouseLeave = newKeyframeHide\n\n      newKeyframeRect.onMouseMove = (event) => {\n        if (timelineHover.hitTest(event.point, { stroke: true, segments: false })) {\n          newKeyframeHoverEffect(event)\n        } else {\n          newKeyframeHide()\n        }\n      }\n\n      timelineHover.onClick = newKeyClick\n      timeline.onClick = newKeyClick\n      newKeyframeRect.onClick = newKeyClick\n\n      // Draw Keyframes\n      list.forEach((keyframe, keyframeIndex) => {\n        const keyframeRect = new this.paper.Path.Rectangle({\n          name: `${item.key}.${prop}.${keyframeIndex}`,\n          point: [timelineStart + keyframe.frame * timelineStep - 5, placing - 10],\n          size: [10, 10],\n          radius: 3,\n          fillColor: 'rgb(30, 155, 255)',\n          rotation: 45,\n          strokeColor: 'white',\n          strokeWidth: 0,\n          shadowColor: 'rgba(0, 0, 0, 0)',\n          shadowBlur: 5,\n        })\n\n        keyframeRect.on('mousedown', this.handleKeyframeClick)\n        keyframeRect.onMouseEnter = () => {\n          this.element.style.cursor = 'pointer'\n          newKeyframeHide()\n        }\n        keyframeRect.onMouseLeave = () => {\n          this.element.style.cursor = 'default'\n        }\n      })\n\n      placementIndex += 1\n    })\n\n    playheadLine.onMouseMove = (event) => {\n      newKeyframeItems.forEach(([\n        timelineHover,\n        newKeyframeRect,\n        newKeyframePlus,\n      ]) => {\n        if (timelineHover.hitTest(event.point)) {\n          /* eslint-disable no-param-reassign */\n          newKeyframeRect.visible = true\n          newKeyframePlus.visible = true\n          newKeyframeRect.position.x = event.point.x\n          newKeyframePlus.position.x = event.point.x + 10\n        } else {\n          newKeyframeRect.visible = false\n          newKeyframePlus.visible = false\n        }\n      })\n    }\n    playheadLine.bringToFront()\n  }\n\n  rebuild() {\n    this.paper.project.clear()\n    this.paper.project.remove()\n    this.buildKeyframeEditorCanvas()\n  }\n\n  buildPlayhead() {\n    const { size, now } = this.props\n    const { timelineStart, timelineStep } = this.timelineMath()\n    const playheadLine = new this.paper.Path.Line({\n      from: [timelineStart + now * timelineStep, 10],\n      to: [timelineStart + now * timelineStep, size.height - 10],\n      strokeColor: 'white',\n      strokeWidth: 1,\n    })\n    const playheadTriangle = new this.paper.Path.RegularPolygon({\n      center: [timelineStart + now * timelineStep, 10],\n      sides: 3,\n      radius: 6,\n      rotation: 180,\n      fillColor: 'white',\n    })\n    return { playheadLine, playheadTriangle }\n  }\n\n  timelineMath() {\n    const { size, frames } = this.props\n    const verticalSpacing = 40\n    const timelineStart = 80\n    const timelineEnd = size.width - verticalSpacing\n    const timelineWidth = timelineEnd - timelineStart\n    const timelineStep = timelineWidth / frames\n    return {\n      verticalSpacing,\n      timelineStart,\n      timelineEnd,\n      timelineWidth,\n      timelineStep,\n    }\n  }\n\n  render() {\n    const { size, item } = this.props\n\n    if (size === undefined || item === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'grey' }}>\n          Select an Item to view its Keyframes.\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <Canvas\n          id=\"keyframe-editor\"\n          width={size.width}\n          height={size.height}\n          hasSize={this.keyframeEditorHasSize}\n        />\n      </div>\n    )\n  }\n}\n\nexport default KeyframeEditor\n","import React, { Component } from 'react'\nimport { autorun } from 'mobx'\nimport { observer } from 'mobx-react'\n\nimport Viewer from './Viewer'\nimport HandleEditor from './HandleEditor'\nimport KeyframeEditor from './KeyframeEditor'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nimport { titleCase } from '../util/string'\n\n@observer\nclass AnimateMode extends Component {\n  state = {\n    heWidth: undefined,\n    keSize: undefined,\n    selectedItemKey: undefined,\n  }\n\n  autorunDisposer\n\n  componentDidMount() {\n    const { canvas } = this.props.store\n    const container = document.getElementById('view-container')\n    setTimeout(() => {\n      const width = Math.round(container.clientWidth) - 20\n      const height = Math.round((9 / 16) * width)\n      canvas.setSize(width, height)\n    }, 1)\n\n    const container2 = document.getElementById('handle-container')\n    setTimeout(() => {\n      const width = Math.round(container2.clientWidth) - 20\n      const height = Math.round(container2.clientHeight) - 20\n      const smallestLength = Math.min(width, height)\n      this.setState({ heWidth: smallestLength })\n    }, 1)\n\n    const container3 = document.getElementById('keyframe-container')\n    setTimeout(() => {\n      const width = Math.round(container3.clientWidth) - 20\n      const height = Math.round(container3.clientHeight) - 20\n      this.setState({ keSize: { width, height } })\n    }, 1)\n\n    this.autorunDisposer = autorun(() => {\n      if (canvas.selected) {\n        this.setState({ selectedItemKey: canvas.selected.key })\n      } else {\n        this.setState({ selectedItemKey: undefined })\n      }\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { tools } = this.props.store\n    if (prevState.selectedItemKey !== this.state.selectedItemKey) {\n      tools.selectKeyframe(undefined)\n    }\n  }\n\n  componentWillUnmount() {\n    const { canvas, project, tools } = this.props.store\n    canvas.selectOff()\n    project.clear()\n    tools.selectKeyframe(undefined)\n    this.autorunDisposer()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n    setTimeout(() => {\n      canvas.setTool(undefined)\n      canvas.setTool('SELECT')\n    }, 20)\n  }\n\n  changeHandlePosition = (handleType, { influence, distance }) => {\n    const { tools, canvas } = this.props.store\n    if (!tools.selectedKeyframe) return\n\n    const handleSuffix = titleCase(handleType)\n    const [kItem, kProp, kIndexStr] = tools.selectedKeyframe.split('.')\n    let kIndex = parseInt(kIndexStr)\n    if (handleType === 'IN') {\n      kIndex += 1\n    }\n\n    const targetHandle = canvas.animatables[kItem].keyframes[kProp][kIndex][`handle${handleSuffix}`]\n    let auxilaryHandle\n    if (kProp === 'x') {\n      auxilaryHandle = canvas.animatables[kItem].keyframes.y[kIndex][`handle${handleSuffix}`]\n    }\n\n    targetHandle.influence += influence\n    targetHandle.distance += distance\n\n    if (auxilaryHandle) {\n      auxilaryHandle.influence += influence\n      auxilaryHandle.distance += distance\n    }\n  }\n\n  render() {\n    const { canvas, animation, tools } = this.props.store\n    const { heWidth, keSize } = this.state\n\n    let keyframeBefore\n    let keyframeAfter\n    if (tools.selectedKeyframe) {\n      const [kItem, kProp, kIndexStr] = tools.selectedKeyframe.split('.')\n      const kIndex = parseInt(kIndexStr)\n      const keyframesOfType = canvas.animatables[kItem].keyframes[kProp]\n      keyframeBefore = keyframesOfType[kIndex]\n      if (kIndex + 1 < keyframesOfType.length) {\n        keyframeAfter = keyframesOfType[kIndex + 1]\n      }\n    }\n\n    return (\n      <Grid\n        gridTemplateRows=\"auto 340px\"\n        gridTemplateColumns=\"auto 400px\"\n      >\n        <GridItem id=\"view-container\" padding=\"10px\" gridArea=\"1 / 1 / 1 / 2\">\n          <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n        </GridItem>\n        <GridItem id=\"handle-container\" gridArea=\"1 / 2 / 1 / 3\" backgroundColor=\"rgb(210, 210, 210)\">\n          <HandleEditor\n            width={heWidth}\n            keyframeKey={tools.selectedKeyframe}\n            keyframeBefore={keyframeBefore}\n            keyframeAfter={keyframeAfter}\n            onMove={this.changeHandlePosition}\n          />\n        </GridItem>\n        <GridItem id=\"keyframe-container\" gridArea=\"2 / 1 / 2 / 3\" backgroundColor=\"rgb(180, 180, 180)\">\n          <KeyframeEditor\n            size={keSize}\n            item={canvas.selected}\n            keyframeKey={tools.selectedKeyframe}\n            keyframe={keyframeBefore}\n            onSelect={tools.selectKeyframe}\n            frames={animation.frames}\n            now={animation.now}\n          />\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default AnimateMode\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\n@observer\nclass PlayController extends Component {\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeyDown, false)\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown, false)\n  }\n\n  handleKeyDown = (event) => {\n    const {\n      play,\n      pause,\n      goToNext,\n      goToPrev,\n      goToFirst,\n      goToLast,\n      playing,\n    } = this.props.animation\n    const { key, shiftKey } = event\n\n    if (key === 'ArrowLeft' && shiftKey) {\n      goToFirst()\n    } else if (key === 'ArrowLeft') {\n      goToPrev()\n    } else if (key === 'ArrowRight' && shiftKey) {\n      goToLast()\n    } else if (key === 'ArrowRight') {\n      goToNext()\n    } else if (key === ' ') {\n      event.stopPropagation()\n      event.preventDefault()\n      if (playing === true) {\n        pause()\n      } else {\n        play()\n      }\n    }\n  }\n\n  render() {\n    const {\n      play,\n      pause,\n      goToNext,\n      goToPrev,\n      goToFirst,\n      goToLast,\n      playing,\n    } = this.props.animation\n\n    return (\n      <Grid gridTemplateColumns=\"30% 1fr 1fr 1fr 1fr 1fr 30%\" height=\"60px\" alignItems=\"center\" justifyItems=\"center\" borderTop=\"1px solid rgb(230, 230, 230)\">\n        <GridItem gridColumnStart=\"2\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToFirst}>&#8676;</button>\n        </GridItem>\n        <GridItem gridColumnStart=\"3\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToPrev}>&#9667;</button>\n        </GridItem>\n        <GridItem gridColumnStart=\"4\">\n          { playing === false ?\n            <button type=\"button\" style={{ margin: 0 }} onClick={play}>&#9658;</button> :\n            <button type=\"button\" style={{ margin: 0 }} onClick={pause}>&#10073; &#10073;</button>\n          }\n        </GridItem>\n        <GridItem gridColumnStart=\"5\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToNext}>\n            <div style={{ transform: 'rotate(180deg)' }}>&#9667;</div>\n          </button>\n        </GridItem>\n        <GridItem gridColumnStart=\"6\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToLast}>&#8677;</button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default PlayController\n","import React from 'react'\n\nconst getWidth = () => (\n  window.innerWidth\n    || document.documentElement.clientWidth\n    || document.body.clientWidth\n)\n\nconst getHeight = () => (\n  window.innerHeight\n    || document.documentElement.clientHeight\n    || document.body.clientHeight\n)\n\nconst withWindowSize = Component => (\n  class extends React.Component {\n    state = {\n      width: getWidth(),\n      height: getHeight(),\n    }\n\n    componentDidMount() {\n      window.addEventListener('resize', this.updateDimensions)\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('resize', this.updateDimensions)\n    }\n\n    updateDimensions = () => {\n      const width = getWidth()\n      const height = getHeight()\n      this.setState({ width, height })\n    }\n\n    render() {\n      const { width, height } = this.state\n      return <Component width={width} height={height} {...this.props} />\n    }\n  }\n)\n\nexport default withWindowSize\nexport {\n  getWidth,\n  getHeight,\n}\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Viewer from './Viewer'\nimport PlayController from './PlayController'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\nimport { getWidth } from '../components/withWindowSize'\n\n@observer\nclass ViewMode extends Component {\n  componentDidMount() {\n    const { canvas } = this.props.store\n    const width = getWidth() - 20\n    const height = Math.round((9 / 16) * width)\n    canvas.setSize(width, height)\n  }\n\n  componentWillUnmount() {\n    const { project } = this.props.store\n    project.clear()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n  }\n\n  render() {\n    const { canvas, animation } = this.props.store\n    return (\n      <Grid\n        gridTemplateRows=\"auto 60px\"\n        alignItems=\"center\"\n      >\n        <GridItem padding=\"10px\">\n          <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n        </GridItem>\n        <PlayController animation={animation} />\n      </Grid>\n    )\n  }\n}\n\nexport default ViewMode\n","var map = {\n\t\"./bare.min.css\": \"v4a6\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"zGb5\";"],"sourceRoot":""}