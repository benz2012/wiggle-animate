{"version":3,"sources":["webpack:///./src/js/prototypes/Canvas.js","webpack:///./src/js/prototypes/ModeStore.js","webpack:///./src/js/prototypes/ToolsStore.js","webpack:///./src/js/util/observeAnimatableTree.js","webpack:///./src/js/prototypes/GalleryStore.js","webpack:///./src/js/store.js","webpack:///./src/js/util/storage.js","webpack:///./src/js/index.jsx","webpack:///./src/js/containers/App.jsx","webpack:///./src/js/components/Playbar.jsx","webpack:///./src/js/containers/Viewer.jsx","webpack:///./src/js/util/download.js","webpack:///./src/js/prototypes/Project.js","webpack:///./src/js/containers/Gallery.jsx","webpack:///./src/js/components/GridItem.jsx","webpack:///./src/js/prototypes/Handle.js","webpack:///./src/js/util/string.js","webpack:///./src/js/prototypes/AnimatableItem.js","webpack:///./src/js/prototypes/items/Circle.js","webpack:///./src/js/prototypes/items/Rectangle.js","webpack:///./src/js/prototypes/items/Text.js","webpack:///./src/js/prototypes/items/index.js","webpack:///./src/js/prototypes/Animation.js","webpack:///./src/js/components/Grid.jsx","webpack:///./src/css/index.js","webpack:///./src/js/containers/ToolController.jsx","webpack:///./src/js/components/IntegerInput.jsx","webpack:///./src/js/components/TextInput.jsx","webpack:///./src/js/components/Modal.jsx","webpack:///./src/js/containers/PropertyEditor.jsx","webpack:///./src/js/containers/ProjectSettings.jsx","webpack:///./src/js/containers/ClearProject.jsx","webpack:///./src/js/containers/BuildMode.jsx","webpack:///./src/js/util/bezierApproximation.js","webpack:///./src/js/prototypes/Keyframe.js","webpack:///./src/js/components/Canvas.jsx","webpack:///./src/js/containers/ExportMode.jsx","webpack:///./src/css/bare.min.css","webpack:///./src/js/containers/ModeController.jsx","webpack:///./src/js/prototypes/HandleEditor.js","webpack:///./src/js/containers/HandleEditor.jsx","webpack:///./src/js/containers/KeyframeEditor.jsx","webpack:///./src/js/containers/AnimateMode.jsx","webpack:///./src/js/containers/PlayController.jsx","webpack:///./src/js/components/withWindowSize.jsx","webpack:///./src/js/containers/ViewMode.jsx","webpack:///./node_modules/file-loader/dist/cjs.js"],"names":["Canvas","rootStore","attatchAndSetup","id","element","document","getElementById","paper","setup","view","autoUpdate","background","Path","Rectangle","topLeft","bottomRight","width","height","fillColor","color","draw","animation","firstFrame","addListenersAndSelect","animatable","item","on","handleItemMouseDown","select","event","stopPropagation","currentTarget","handleViewMouseDown","deselect","forEachAnimatable","callback","Object","values","animatables","forEach","build","create","frame","frameToDraw","now","update","selectOn","selectOff","off","this","initialize","prevWidth","prevHeight","undefined","_color","tool","selected","setSize","entries","reduce","output","key","toJSON","setSizeAction","action","setTimeout","value","observable","remove","clone","nextTool","entering","toolId","prevTool","exiting","mode","settings","clear","name","Mode","current","m","Tools","selectedKeyframe","keyframe","observeAnimatableTree","observableObj","constructor","OBSERVABLES","map","keys","keyframes","keyFrType","Gallery","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","clipsRef","ref","RootStore","reset","project","canvas","tools","PaperScope","Project","Animation","ModeStore","ToolsStore","gallery","GalleryStore","pathArray","window","location","pathname","split","storageEnabled","localStorage","setItem","e","length","projectObj","getItem","load","autorun","projectAsJSON","save","delay","reaction","store","appNode","ReactDOM","render","App","observer","Component","props","minHeight","gridTemplateRows","hot","module","Playbar","fullWidth","totalFrames","inPoint","outPoint","ABSOLUTE_FIRST","playbarWidth","per","marker","head","parseInt","tail","activeHead","activeTail","style","display","playbarStyle","backgroundColor","marginTop","margin","Viewer","canvasHasSize","onSetup","Fragment","hasSize","frames","lastFrame","FIRST","downloadJSON","data","basename","download","filename","type","file","Blob","navigator","msSaveOrOpenBlob","elm","createElement","url","URL","createObjectURL","href","body","appendChild","click","removeChild","revokeObjectURL","setIn","setOut","inputJSON","fileName","input","JSON","parse","setName","replace","inputItems","loadFromFile","targetFile","target","files","reader","FileReader","onload","result","readAsText","stringify","object","publish","push","set","inputBuilt","state","clips","clip","json","buildAnimatables","play","itemKey","itemObj","itemClass","properties","items","add","inputKeyframes","accum","keyframeProp","keyframeList","Keyframe","fromJSON","container","Math","round","clientWidth","setState","newClip","simpleHash","val","playable","obj","prevState","firstClip","slice","prevProps","prevClipsLen","targetIndex","padding","position","zIndex","marginBottom","paddingTop","GridItem","children","Handle","influence","distance","_influence","_distance","x","y","MAX","newX","newY","titleCase","str","splitStr","toLowerCase","i","charAt","toUpperCase","substring","join","hash","charCodeAt","AnimatableItem","absolute","dimension","relative","fraction","valueForFrame","includes","indexOf","sort","a","b","where","before","after","interpolate","hue","floor","random","saturation","brightness","class","scale","rotation","prop","rotate","property","ignorePairings","valueToKey","k","paired","valueToPair","kP","keyframesPaired","updateKeyframes","filter","keyframesY","setCanvas","sharedProps","onCreate","setUntrackedValues","xKeyframes","yKeyframes","xValue","yValue","activeLayer","_x","_y","_scale","scaleBy","_rotation","rotateBy","_fillColor","X","Y","SCALE","ROTATION","FILL_COLOR","Circle","radius","itemProps","center","_radius","recreate","RADIUS","absX","absY","absWidth","absHeight","point","size","max","_width","_height","WIDTH","HEIGHT","Text","content","fontSize","PointText","resetPositionFromSizeChange","_content","_fontSize","FONT_SIZE","nextFrame","later","prevFrame","earlier","fps","playing","sync","requestId","f","goToFrame","animateAtRate","pause","cancelAnimationFrame","func","interval","then","Date","loop","requestAnimationFrame","delta","Grid","cssContext","require","ToolController","choose","preventDefault","setTool","addCircle","existing","circle","addRectangle","rect","addText","text","onClick","primary","transform","IntegerInput","localValue","onChange","onBlur","setValue","possibleInt","Number","isInteger","handleKeyDown","shiftKey","incrementBy","decrementBy","changeBy","operation","amount","next","marginRight","textAlign","onKeyDown","TextInput","Modal","open","handleClose","clickawayEl","useRef","onClickaway","contains","PropertyEditor","propertySetter","existingKeyframe","find","addKey","classControls","left","top","overflow","border","ProjectSettings","setLength","setColor","closeModal","step","flexDirection","ClearProject","justifyContent","BuildMode","ready","inputItemsExist","autorunDisposer","Boolean","prevInputItemsExist","gridTemplateColumns","gridArea","alignSelf","findPointWithLines","points","t","newPoints","currPoint","nextPoint","bezierApproximation","handlePoints","samples","Error","bezierPoints","segments","x2","x3","y2","y3","log10","afterPointIndex","findIndex","lerp","x1","y1","xInterp","handleIn","handleOut","k1","k2","curve","timeRatio","valueRatio","testForAvailability","ExportMode","loadThenBuild","saveThenDownload","justifyItems","htmlFor","exports","ModeController","navigate","textContent","borderBottom","alignItems","HandleEditor","trueWidth","keyframeBefore","keyframeAfter","onMove","attatchTo","handleBefore","absoluteHandlePosition","handleAfter","topRight","bottomLeft","spacing","STEP","gridline","SymbolDefinition","Line","from","to","strokeColor","strokeWidth","offset","place","Point","setVisualCurveHandles","stringStyle","handleBeforeString","handleAfterString","handleMovable","Color","handleStationary","onMouseEnter","cursor","onMouseLeave","onMouseDrag","travelled","subtract","xChange","abs","yChange","xSign","sign","ySign","newPosition","lastSegment","onMouseUp","firstSegment","handlePosition","handleEditor","handleEditorHasSize","buildHandleEditorCanvas","HandleEditorInstance","init","React","keyframeKey","destroy","KeyframeEditor","previouslyClickedKeyframe","keyframeEditorHasSize","buildKeyframeEditorCanvas","handleKeyframeClick","onSelect","shadowColor","alpha","handleKeyUp","removeKey","rebuild","timelineMath","verticalSpacing","timelineStart","timelineEnd","timelineStep","placementIndex","playheadLine","buildPlayhead","newKeyframeItems","list","propName","placing","timelineHover","timeline","newKeyframeRect","visible","newKeyframePlus","newKeyframeHoverEffect","newKeyframeHide","newKeyClick","onMouseMove","hitTest","stroke","keyframeIndex","keyframeRect","shadowBlur","bringToFront","addEventListener","removeEventListener","playheadTriangle","RegularPolygon","sides","timelineWidth","AnimateMode","heWidth","keSize","selectedItemKey","changeHandlePosition","handleType","handleSuffix","kItem","kProp","kIndexStr","kIndex","auxilaryHandle","targetHandle","container2","clientHeight","smallestLength","min","container3","selectKeyframe","keyframesOfType","PlayController","goToNext","goToPrev","goToFirst","goToLast","borderTop","gridColumnStart","getWidth","innerWidth","documentElement","ViewMode","webpackContext","req","webpackContextResolve","__webpack_require__","o","code","webpackContextKeys","resolve"],"mappings":"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","file":"app.7dd626b0.js","sourcesContent":["import { observable, action } from 'mobx'\n\nclass Canvas {\n  @observable width\n  @observable height\n  @observable _color\n  @observable background\n  @observable animatables\n  @observable tool\n  @observable selected\n\n  constructor(rootStore) {\n    this.rootStore = rootStore\n    this.paper = rootStore.paper\n    this.initialize()\n  }\n\n  initialize() {\n    let prevWidth\n    let prevHeight\n    if (this.width !== undefined) {\n      prevWidth = this.width\n      prevHeight = this.height\n    }\n\n    this.width = undefined\n    this.height = undefined\n    this._color = '#000000'\n    this.animatables = {}\n    this.tool = undefined\n    this.selected = undefined\n\n    if (prevWidth !== undefined) {\n      this.setSize(prevWidth, prevHeight)\n    }\n  }\n\n  toJSON() {\n    return ({\n      color: this.color,\n      animatables: Object.entries(this.animatables).reduce((output, [key, animatable]) => {\n        output[key] = animatable.toJSON() // eslint-disable-line\n        return output\n      }, {}),\n    })\n  }\n\n  setSize(width, height) {\n    // allows the canvas element one tick to recognize size changes\n    const setSizeAction = action(() => {\n      this.height = height\n      this.width = width\n    })\n    setTimeout(setSizeAction, 1)\n  }\n\n  attatchAndSetup = (id) => {\n    const element = document.getElementById(id)\n    this.paper.setup(element)\n    this.paper.view.autoUpdate = false\n    this.background = new this.paper.Path.Rectangle({\n      topLeft: [0, 0],\n      bottomRight: [this.paper.view.element.width, this.paper.view.element.height],\n      fillColor: this.color,\n    })\n    this.draw(this.rootStore.animation.firstFrame)\n  }\n\n  get color() { return this._color }\n  set color(value) {\n    this._color = value\n    this.background.fillColor = value\n  }\n\n  @action add = (animatable) => {\n    animatable.create(this)\n    this.animatables = {\n      ...this.animatables,\n      [animatable.key]: animatable,\n    }\n\n    if (this.tool === 'SELECT') {\n      this.addListenersAndSelect(animatable)\n    }\n\n    this.draw()\n  }\n\n  @action remove = (animatable) => {\n    animatable.item.off('mousedown', this.handleItemMouseDown)\n    animatable.item.remove()\n\n    const clone = { ...this.animatables }\n    delete clone[animatable.key]\n    this.animatables = clone\n    this.draw()\n  }\n\n  @action setTool = (nextTool) => {\n    const prevTool = this.tool\n\n    const entering = toolId => (prevTool !== toolId && nextTool === toolId)\n    const exiting = toolId => (prevTool === toolId && nextTool !== toolId)\n\n    if (entering('SELECT')) { this.selectOn() }\n    if (exiting('SELECT')) { this.selectOff() }\n\n    if (entering('SETTINGS')) { this.rootStore.mode.settings = true }\n    if (exiting('SETTINGS')) { this.rootStore.mode.settings = false }\n\n    if (entering('CLEAR')) { this.rootStore.mode.clear = true }\n    if (exiting('CLEAR')) { this.rootStore.mode.clear = false }\n\n    // Finally, set the tool in-memory\n    this.tool = nextTool\n  }\n\n  @action select = (item) => {\n    this.deselect()\n    item.selected = true // eslint-disable-line no-param-reassign\n    this.selected = this.animatables[item.name]\n    this.paper.view.update()\n  }\n\n  @action deselect = () => {\n    if (this.selected) {\n      this.selected.item.selected = false\n      this.selected = undefined\n    }\n    this.paper.view.update()\n  }\n\n  addListenersAndSelect = (animatable) => {\n    animatable.item.on('mousedown', this.handleItemMouseDown)\n    this.select(animatable.item)\n  }\n\n  handleItemMouseDown = (event) => {\n    event.stopPropagation()\n    this.select(event.currentTarget)\n  }\n\n  handleViewMouseDown = (event) => {\n    event.stopPropagation()\n    this.deselect()\n  }\n\n  forEachAnimatable = callback => (\n    Object.values(this.animatables).forEach(callback)\n  )\n\n  build = () => {\n    this.forEachAnimatable((animatable) => { animatable.create(this) })\n    this.draw()\n  }\n\n  draw = (frame) => {\n    const frameToDraw = frame || this.rootStore.animation.now\n    this.forEachAnimatable((animatable) => { animatable.draw(frameToDraw) })\n    if (this.paper.view) this.paper.view.update()\n  }\n\n  selectOn = () => {\n    this.forEachAnimatable((animatable) => {\n      animatable.item.on('mousedown', this.handleItemMouseDown)\n    })\n    this.paper.view.on('mousedown', this.handleViewMouseDown)\n  }\n\n  selectOff = () => {\n    this.forEachAnimatable((animatable) => {\n      animatable.item.off('mousedown', this.handleItemMouseDown)\n    })\n    this.paper.view.off('mousedown', this.handleViewMouseDown)\n    this.deselect()\n  }\n}\n\nexport default Canvas\n","import { observable, action } from 'mobx'\n\nclass Mode {\n  @observable current\n  @observable settings\n  @observable clear\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.current = 'BUILD'\n    this.settings = false\n    this.clear = false\n  }\n\n  @action set = (m) => {\n    this.current = m\n  }\n}\n\nexport default Mode\n","import { observable, action } from 'mobx'\n\nclass Tools {\n  @observable selectedKeyframe\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.selectedKeyframe = undefined\n  }\n\n  @action selectKeyframe = (keyframe) => {\n    this.selectedKeyframe = keyframe\n  }\n}\n\nexport default Tools\n","const observeAnimatableTree = (observableObj) => {\n  const observableKeys = observableObj.constructor.OBSERVABLES\n  return observableKeys.map((key) => {\n    if (key === 'keyframes') {\n      return Object.keys(observableObj.keyframes).map(keyFrType => (\n        observableObj.keyframes[keyFrType].map(observeAnimatableTree)\n      ))\n    }\n\n    const value = observableObj[key]\n    if (value.constructor.OBSERVABLES) {\n      return observeAnimatableTree(value)\n    }\n\n    return value\n  })\n}\n\nexport default observeAnimatableTree\n","import { observable } from 'mobx'\n\nimport * as firebase from 'firebase/app'\nimport 'firebase/database'\n\nclass Gallery {\n  @observable clipsRef\n\n  constructor() {\n    firebase.initializeApp({\n      apiKey: 'AIzaSyCdglP4EAub1kYXJrXag3vaNIxxQgEZTQk',\n      authDomain: 'micro-graph.firebaseapp.com',\n      databaseURL: 'https://micro-graph.firebaseio.com',\n      projectId: 'micro-graph',\n      storageBucket: 'micro-graph.appspot.com',\n      messagingSenderId: '662102370030',\n      appId: '1:662102370030:web:46cfe6a252ed6cc47b75ff',\n    })\n\n    this.clipsRef = firebase.database().ref('clips')\n  }\n}\n\nexport default Gallery\n","import { observable, reaction, autorun } from 'mobx'\nimport paper from 'paper'\n\nimport Project from './prototypes/Project'\nimport Canvas from './prototypes/Canvas'\nimport Animation from './prototypes/Animation'\nimport ModeStore from './prototypes/ModeStore'\nimport ToolsStore from './prototypes/ToolsStore'\nimport GalleryStore from './prototypes/GalleryStore'\n\nimport observeAnimatableTree from './util/observeAnimatableTree'\nimport { storageEnabled } from './util/storage'\n\nclass RootStore {\n  @observable project\n  @observable canvas\n  @observable animation\n  @observable mode\n  @observable tools\n  @observable gallery\n\n  constructor() {\n    this.paper = new paper.PaperScope()\n\n    this.project = new Project(this)\n    this.canvas = new Canvas(this)\n    this.animation = new Animation()\n    this.mode = new ModeStore()\n    this.tools = new ToolsStore()\n    this.gallery = new GalleryStore()\n\n    // Auto Save & Auto Load\n    const { pathname } = window.location\n    const pathArray = pathname.split('/')\n\n    if (\n      storageEnabled() &&\n      (pathArray.length > 1 && pathArray[1] !== 'gallery')\n    ) {\n      const projectObj = localStorage.getItem('micrograph.project')\n      if (projectObj) {\n        setTimeout(() => {\n          this.project.load(projectObj)\n        }, 100)\n      }\n\n      autorun(() => {\n        const projectAsJSON = this.project.save()\n        localStorage.setItem('micrograph.project', projectAsJSON)\n      }, { delay: 300 })\n    }\n\n    // Reacts to all changes made to animatable item properties and redraws the canvas\n    reaction(\n      () => ([\n        this.animation.now,\n        this.canvas.color,\n        Object.values(this.canvas.animatables).map(observeAnimatableTree),\n      ]),\n      () => this.canvas.draw()\n    )\n  }\n\n  reset = () => {\n    this.project.initialize()\n    this.canvas.initialize()\n    this.animation.initialize()\n    this.mode.initialize()\n    this.tools.initialize()\n  }\n}\n\nexport default RootStore\n","const storageEnabled = () => {\n  try {\n    localStorage.setItem('_test', 'test')\n  } catch (e) {\n    return false\n  }\n  return true\n}\n\nconst storageSet = (key, value) => {\n  localStorage.setItem(key, JSON.stringify(value))\n}\n\nconst storageGet = (key) => {\n  const value = localStorage.getItem(key)\n  return value && JSON.parse(value)\n}\n\nexport {\n  storageEnabled,\n  storageSet,\n  storageGet,\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\n// Root Application Container\nimport App from './containers/App'\nimport RootStore from './store'\n\n// Styles\nimport '../css'\n\nconst store = new RootStore()\nconst appNode = document.getElementById('app')\n\nReactDOM.render(\n  <App store={store} />,\n  appNode\n)\n","import React, { Component } from 'react'\nimport { hot } from 'react-hot-loader'\nimport { observer } from 'mobx-react'\n\nimport ModeController from './ModeController'\nimport BuildMode from './BuildMode'\nimport AnimateMode from './AnimateMode'\nimport ViewMode from './ViewMode'\nimport ExportMode from './ExportMode'\nimport Gallery from './Gallery'\nimport Grid from '../components/Grid'\n\n@observer\nclass App extends Component {\n  componentDidMount() {\n    // const { store } = this.props\n    // store.canvas.setTool('SETTINGS')\n  }\n\n  render() {\n    const { store } = this.props\n    const { pathname } = window.location\n\n    const pathArray = pathname.split('/')\n    if (pathArray.length > 1 && pathArray[1] === 'gallery') {\n      return <Gallery clipsRef={store.gallery.clipsRef} />\n    }\n\n    return (\n      <Grid\n        minHeight=\"100vh\"\n        gridTemplateRows=\"60px 1fr\"\n      >\n        <ModeController mode={store.mode} />\n        {store.mode.current === 'BUILD' &&\n          <BuildMode store={store} />\n        }\n        {store.mode.current === 'ANIMATE' &&\n          <AnimateMode store={store} />\n        }\n        {store.mode.current === 'VIEW' &&\n          <ViewMode store={store} />\n        }\n        {store.mode.current === 'EXPORT' &&\n          <ExportMode store={store} />\n        }\n      </Grid>\n    )\n  }\n}\n\nexport default hot(module)(App)\n","import React from 'react'\n\nconst playbarStyle = { height: '10px', margin: '10px 0px' }\n\nconst Playbar = ({\n  fullWidth,\n  totalFrames,\n  inPoint,\n  outPoint,\n  now,\n  ABSOLUTE_FIRST,\n}) => {\n  const playbarWidth = fullWidth || 0\n\n  const per = playbarWidth / totalFrames\n  const marker = totalFrames > 1 ? per : 0\n  const head = parseInt((inPoint - ABSOLUTE_FIRST) * per)\n  const tail = parseInt((totalFrames - outPoint) * per)\n\n  let activeHead = parseInt((now * per) - head)\n  if (totalFrames === 1) {\n    activeHead = per\n  } else if (now === inPoint) {\n    activeHead = 0\n  } else if (now === outPoint) {\n    activeHead = playbarWidth - head - tail - marker\n  }\n  const activeTail = now === outPoint ? 0 : playbarWidth - head - tail - activeHead - marker\n\n  return (\n    <div style={{ display: 'flex' }}>\n      <div style={{\n        ...playbarStyle,\n        width: head,\n        backgroundColor: 'rgb(150, 160, 170)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: activeHead,\n        backgroundColor: 'rgb(220, 225, 240)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: marker,\n        height: '20px',\n        marginTop: '5px',\n        backgroundColor: 'rgb(30, 155, 255)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: activeTail,\n        backgroundColor: 'rgb(220, 225, 240)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: tail,\n        backgroundColor: 'rgb(150, 160, 170)' }}\n      />\n    </div>\n  )\n}\n\nexport default Playbar\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Animation from '../prototypes/Animation'\nimport Canvas from '../components/Canvas'\nimport Playbar from '../components/Playbar'\n\n@observer\nclass Viewer extends Component {\n  canvasHasSize = () => {\n    const { canvas, onSetup } = this.props\n    canvas.attatchAndSetup('paper-canvas')\n    onSetup()\n  }\n\n  render() {\n    const { canvas, animation } = this.props\n    return (\n      <React.Fragment>\n        <Canvas\n          id=\"paper-canvas\"\n          width={canvas.width}\n          height={canvas.height}\n          hasSize={this.canvasHasSize}\n        />\n        <Playbar\n          fullWidth={canvas.width}\n          totalFrames={animation.frames}\n          inPoint={animation.firstFrame}\n          outPoint={animation.lastFrame}\n          now={animation.now}\n          ABSOLUTE_FIRST={Animation.FIRST}\n        />\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Viewer\n","const download = (data, filename, type) => {\n  const file = new Blob([data], { type })\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveOrOpenBlob(file, filename)\n  } else {\n    const elm = document.createElement('a')\n    const url = window.URL.createObjectURL(file)\n\n    elm.href = url\n    elm.download = filename\n\n    document.body.appendChild(elm)\n    elm.click()\n\n    setTimeout(() => {\n      document.body.removeChild(elm)\n      window.URL.revokeObjectURL(url)\n    })\n  }\n}\n\nconst downloadJSON = (data, basename) => (\n  download(data, `${basename}.json`, 'text/json')\n)\n\nexport {\n  download,\n  downloadJSON,\n}\n","import { observable, action } from 'mobx'\n\nimport Animation from './Animation'\nimport { downloadJSON } from '../util/download'\n\nclass Project {\n  @observable name\n  @observable inputItems\n  @observable inputBuilt\n\n  constructor(rootStore) {\n    this.rootStore = rootStore\n    this.paper = rootStore.paper\n    this.initialize()\n  }\n\n  initialize() {\n    if (this.paper.project) {\n      this.paper.project.clear()\n      this.paper.project.remove()\n    }\n    this.name = 'My Animation'\n    this.inputItems = undefined\n    this.inputBuilt = false\n  }\n\n  toJSON() {\n    return ({\n      name: this.name,\n    })\n  }\n\n  @action setName(name) {\n    this.name = name\n  }\n\n  clear = () => {\n    this.paper.project.clear()\n    this.paper.project.remove()\n\n    const { canvas, animation } = this.rootStore\n    canvas.setSize(undefined, undefined)\n    animation.setIn(Animation.FIRST)\n    animation.setOut(animation.frames)\n  }\n\n  load = (inputJSON, fileName, callback) => {\n    const { canvas, animation } = this.rootStore\n    const input = JSON.parse(inputJSON)\n\n    const name = fileName || input.project.name\n    this.setName(name.replace(/\\.[^/.]+$/, ''))\n\n    Object.keys(input.animation).forEach((key) => {\n      animation[key] = input.animation[key]\n    })\n\n    Object.keys(input.canvas).forEach((key) => {\n      if (key === 'animatables') {\n        this.inputItems = input.canvas.animatables\n      } else {\n        canvas[key] = input.canvas[key]\n      }\n    })\n\n    if (callback) callback()\n  }\n\n  loadFromFile = (event, callback) => {\n    const { files } = event.target\n    const targetFile = files[0]\n    const reader = new FileReader()\n    reader.onload = () => this.load(reader.result, targetFile.name, callback)\n\n    this.rootStore.reset()\n    reader.readAsText(targetFile)\n  }\n\n  save = () => {\n    /* eslint no-param-reassign: 0 */\n    const { canvas, animation } = this.rootStore\n    const projectAsJSON = JSON.stringify({\n      project: this.toJSON(),\n      animation: animation.toJSON(),\n      canvas: canvas.toJSON(),\n    })\n    return projectAsJSON\n  }\n\n  download = (object) => {\n    downloadJSON(object, this.name)\n  }\n\n  publish = () => {\n    const projectAsJSON = this.save()\n    this.rootStore.gallery.clipsRef.push().set(projectAsJSON)\n  }\n\n  // render() {\n  //   // render canvas animation to frames\n  // }\n}\n\nexport default Project\n","import React, { Component } from 'react'\nimport { reaction } from 'mobx'\nimport { observer } from 'mobx-react'\nimport paper from 'paper'\n\nimport CanvasEl from '../components/Canvas'\n\nimport Project from '../prototypes/Project'\nimport Canvas from '../prototypes/Canvas'\nimport Animation from '../prototypes/Animation'\nimport Keyframe from '../prototypes/Keyframe'\nimport items from '../prototypes/items'\n\nimport { simpleHash } from '../util/string'\n\nconst playable = () => {\n  const obj = {}\n  obj.paper = new paper.PaperScope()\n  obj.project = new Project(obj)\n  obj.canvas = new Canvas(obj)\n  obj.animation = new Animation()\n  return obj\n}\n\n@observer\nclass Gallery extends Component {\n  state = {\n    clips: [],\n    width: undefined,\n    height: undefined,\n  }\n\n  componentDidMount() {\n    const container = document.getElementById('playback-container')\n    const width = Math.round(container.clientWidth) - 20\n    const height = Math.round((9 / 16) * width)\n    this.setState({ width, height })\n\n\n    const { clipsRef } = this.props\n    clipsRef.on('child_added', (data) => {\n      const newClip = {\n        key: `${simpleHash(data.val())}`,\n        json: data.val(),\n        clip: playable(),\n      }\n\n      this.setState((prevState) => {\n        const firstClip = prevState.clips[0]\n        if (firstClip) {\n          return ({\n            clips: [\n              firstClip,\n              newClip,\n              ...prevState.clips.slice(1),\n            ],\n          })\n        }\n        return ({ clips: [newClip] })\n      })\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { width, height, clips } = this.state\n    const prevClipsLen = prevState.clips.length\n    if (clips.length > prevClipsLen) {\n      const targetIndex = prevClipsLen === 0 ? 0 : 1\n      clips[targetIndex].clip.canvas.setSize(width, height)\n      reaction(\n        () => ([\n          clips[targetIndex].clip.animation.now,\n        ]),\n        () => clips[targetIndex].clip.canvas.draw()\n      )\n    }\n  }\n\n  canvasHasSize = (key, clip, json) => () => {\n    clip.canvas.attatchAndSetup(`paper-canvas-${key}`)\n    clip.canvas.build()\n    clip.project.load(json)\n    this.buildAnimatables(clip)\n    clip.animation.play()\n  }\n\n  buildAnimatables = (clip) => {\n    Object.entries(clip.project.inputItems).forEach(([itemKey, itemObj]) => {\n      const { class: itemClass, keyframes, ...properties } = itemObj\n\n      const animatable = new items[itemClass](itemKey)\n      clip.canvas.add(animatable)\n\n      const inputKeyframes = Object.entries(keyframes)\n        .reduce((accum, [keyframeProp, keyframeList]) => {\n          /* eslint no-param-reassign: 0 */\n          accum[keyframeProp] = keyframeList.map(Keyframe.fromJSON)\n          return accum\n        }, {})\n      animatable.keyframes = {\n        ...this.keyframes,\n        ...inputKeyframes,\n      }\n\n      Object.entries(properties).forEach(([key, value]) => {\n        animatable[key] = value\n      })\n    })\n\n    clip.canvas.deselect()\n    clip.canvas.draw()\n  }\n\n  render() {\n    const { clips } = this.state\n\n    return (\n      <div>\n        <div style={{ width: '100%', padding: '10px', position: 'fixed', backgroundColor: 'white', zIndex: '100' }}>\n          <h1 style={{ marginBottom: '0px' }}>Welcome to the Gallery</h1>\n          <small>{clips.length} Published Animations, scroll to see them!</small>\n        </div>\n\n        <div id=\"playback-container\" style={{ width: '100%', padding: '0px 10px', paddingTop: '100px' }}>\n          {clips.length === 0 ? (\n            <p>Loading Clips...</p>\n          ) : (\n            clips.map(({ clip, key, json }) => (\n              <div key={key} style={{ padding: '10px 0px' }}>\n                <h4 style={{ marginBottom: '4px' }}>{clip.project.name}</h4>\n                <CanvasEl\n                  id={`paper-canvas-${key}`}\n                  width={clip.canvas.width}\n                  height={clip.canvas.height}\n                  hasSize={this.canvasHasSize(key, clip, json)}\n                />\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Gallery\n","import React from 'react'\n\nconst GridItem = ({ id, children, ...style }) => (\n  <div id={id} style={style}>\n    {children}\n  </div>\n)\n\nexport default GridItem\n","import { observable } from 'mobx'\n\nclass Handle {\n  static get MAX() { return 100 }\n  static get STEP() { return 10 }\n  static get OBSERVABLES() {\n    return ['influence', 'distance']\n  }\n\n  @observable _influence\n  @observable _distance\n\n  constructor(type) {\n    this.type = type\n    this.influence = 50\n    this.distance = 0\n  }\n\n  toJSON() {\n    return ({\n      type: this.type,\n      influence: this.influence,\n      distance: this.distance,\n    })\n  }\n\n  get influence() { return this._influence }\n  get distance() { return this._distance }\n  get position() {\n    let x = this.influence\n    let y = this.distance\n    if (this.type === 'IN') {\n      x = Handle.MAX - this.influence\n      y = Handle.MAX - this.distance\n    }\n    x /= Handle.MAX\n    y /= Handle.MAX\n    return { x, y }\n  }\n\n  set influence(value) {\n    this._influence = value\n  }\n\n  set distance(value) {\n    this._distance = value\n  }\n\n  set position({ x, y }) {\n    const newX = x * Handle.MAX\n    const newY = x * Handle.MAX\n    if (this.type === 'IN') {\n      this.influence = Handle.MAX - newX\n      this.distance = Handle.MAX - newY\n    } else {\n      this.influence = newX\n      this.distance = newY\n    }\n  }\n}\n\nexport default Handle\n","const titleCase = (str) => {\n  /* Convert `any string` into `Any String`, including replacing underscores\n    with spaces */\n  const splitStr = str.toLowerCase().split(/[\\s_]+/)\n  for (let i = 0; i < splitStr.length; i += 1) {\n    splitStr[i] = splitStr[i].charAt(0).toUpperCase() + splitStr[i].substring(1)\n  }\n  return splitStr.join(' ')\n}\n\nconst simpleHash = (str) => {\n  /* eslint no-bitwise: 0 */\n  let hash = 0\n  if (str.length === 0) return hash\n\n  for (let i = 0; i < str.length; i += 1) {\n    const char = str.charCodeAt(i)\n    hash = ((hash << 5) - hash) + char\n    hash &= hash\n  }\n\n  return hash\n}\n\nexport {\n  titleCase,\n  simpleHash,\n}\n","import { observable, action } from 'mobx'\n\nimport Keyframe from './Keyframe'\n\nclass AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get X() { return 50 }\n  static get Y() { return 50 }\n\n  // Absolute Values\n  static get SCALE() { return 100 }\n  static get ROTATION() { return 0 }\n  static get FILL_COLOR() {\n    return {\n      hue: Math.floor(Math.random() * 361),\n      saturation: 0.4,\n      brightness: 1,\n    }\n  }\n\n  static get OBSERVABLES() {\n    return ['x', 'y', 'scale', 'rotation', 'fillColor', 'keyframes']\n  }\n\n  constructor(key) {\n    this.key = key\n    this.paper = undefined\n  }\n\n  @observable canvas\n  @observable _x = AnimatableItem.X\n  @observable _y = AnimatableItem.Y\n  @observable _scale = AnimatableItem.SCALE\n  @observable _rotation = AnimatableItem.ROTATION\n  @observable _fillColor = AnimatableItem.FILL_COLOR\n  @observable keyframes = {\n    x: observable([]),\n    y: observable([]),\n    scale: observable([]),\n    rotation: observable([]),\n  }\n\n  toJSON() {\n    return ({\n      class: this.constructor.name,\n      x: this.x,\n      y: this.y,\n      scale: this.scale,\n      rotation: this.rotation,\n      fillColor: this.fillColor,\n      keyframes: Object.entries(this.keyframes).reduce(\n        (output, [prop, keyframeList]) => {\n          /* eslint no-param-reassign: 0 */\n          output[prop] = keyframeList.map(keyframe => keyframe.toJSON())\n          return output\n        }, {}\n      ),\n    })\n  }\n\n  get item() { return this.paper.project.activeLayer.children[this.key] }\n  get x() { return this._x }\n  get y() { return this._y }\n  get position() { return { x: this.x, y: this.y } }\n  get scale() { return this._scale }\n  get rotation() { return this._rotation }\n  get fillColor() { return this._fillColor }\n\n  set x(value) {\n    this.item.position.x = this.absolute(value)\n    this._x = value\n  }\n\n  set y(value) {\n    this.item.position.y = this.absolute(value, 'height')\n    this._y = value\n  }\n\n  set position({ x, y }) {\n    this.x = x\n    this.y = y\n  }\n\n  set scale(value) {\n    if (this.scale === 0 && value !== 0) {\n      this.item.remove()\n      this.create(this.canvas)\n      this.item.scale(this.fraction(value))\n    } else {\n      const scaleBy = value / this.scale\n      this.item.scale(scaleBy)\n    }\n    this._scale = value\n  }\n\n  set rotation(value) {\n    const rotateBy = value - this.rotation\n    this.item.rotate(rotateBy)\n    this._rotation = value\n  }\n\n  set fillColor(value) {\n    this.item.fillColor = value\n    this._fillColor = value\n  }\n\n  @action setCanvas(canvas) {\n    this.canvas = canvas\n    this.paper = canvas.paper\n  }\n\n  @action setUntrackedValues() {\n    this.item.scale(this.fraction(this.scale))\n    this.item.rotate(this.rotation)\n  }\n\n  @action updateKeyframes(property, keyframes) {\n    this.keyframes = {\n      ...this.keyframes,\n      [property]: keyframes,\n    }\n  }\n\n  addKey(property, frame, value = undefined, ignorePairings = false) {\n    const valueToKey = value || this[property]\n    const k = new Keyframe(frame, valueToKey)\n    const keyframes = [...this.keyframes[property], k]\n    keyframes.sort(Keyframe.sort)\n\n    if (!ignorePairings && ['x', 'y'].includes(property)) {\n      let paired\n      if (property === 'x') { paired = 'y' }\n      if (property === 'y') { paired = 'x' }\n\n      const valueToPair = this[paired]\n      const kP = new Keyframe(frame, valueToPair)\n      const keyframesPaired = [...this.keyframes[paired], kP]\n      keyframesPaired.sort(Keyframe.sort)\n\n      this.keyframes = {\n        ...this.keyframes,\n        [property]: keyframes,\n        [paired]: keyframesPaired,\n      }\n    } else {\n      this.updateKeyframes(property, keyframes)\n    }\n\n    return k\n  }\n\n  removeKey(property, frame) {\n    let keyframes = [...this.keyframes[property]]\n    keyframes = keyframes.filter(k => k.frame !== frame)\n\n    if (property === 'x') {\n      let keyframesY = [...this.keyframes.y]\n      keyframesY = keyframesY.filter(k => k.frame !== frame)\n      this.keyframes = {\n        ...this.keyframes,\n        x: keyframes,\n        y: keyframesY,\n      }\n    } else {\n      this.updateKeyframes(property, keyframes)\n    }\n  }\n\n  absolute = (value, dimension = 'width') => (\n    (value / 100) * this.canvas[dimension]\n  )\n\n  relative = (value, dimension = 'width') => (\n    (value * 100) / this.canvas[dimension]\n  )\n\n  fraction = value => (\n    value / 100\n  )\n\n  create(canvas) {\n    if (this.canvas === undefined) this.setCanvas(canvas)\n\n    const sharedProps = {\n      name: this.key,\n      fillColor: this.fillColor,\n    }\n\n    if (typeof this.onCreate === 'function') {\n      this.onCreate(sharedProps)\n    }\n\n    if (this.item !== undefined) this.setUntrackedValues()\n  }\n\n  recreate() {\n    this.item.remove()\n    this.create(this.canvas)\n    this.canvas.addListenersAndSelect(this)\n  }\n\n  draw(frame) {\n    if (this.item === undefined) return\n\n    Object.entries(this.keyframes).forEach(([property, keyframes]) => {\n      // Ignore `y` property\n      if (property === 'y') return\n      if (property === 'x') {\n        // Interpret `x` & `y` at the same time\n        const xKeyframes = keyframes\n        const yKeyframes = this.keyframes.y\n        if (xKeyframes.length === 0 && yKeyframes.length === 0) return\n        const xValue = this.valueForFrame(frame, xKeyframes)\n        const yValue = this.valueForFrame(frame, yKeyframes)\n        this.position = { x: xValue, y: yValue }\n      } else {\n        // Interpret all other properties individually\n        if (keyframes.length === 0) return\n        const value = this.valueForFrame(frame, keyframes)\n        this[property] = value\n      }\n    })\n  }\n\n  valueForFrame = (frame, keyframes) => {\n    const frames = keyframes.map(key => key.frame)\n\n    // is frame a keyframe\n    if (frames.includes(frame)) {\n      const where = frames.indexOf(frame)\n      return keyframes[where].value\n    }\n\n    // where is frame with respect to keyframes\n    frames.push(frame)\n    frames.sort((a, b) => a - b)\n    const where = frames.indexOf(frame)\n\n    // is frame before or after last key\n    if (where === 0) return keyframes[0].value\n    if (where === frames.length - 1) return keyframes[keyframes.length - 1].value\n\n    // frame is between two keys\n    const before = keyframes[where - 1]\n    const after = keyframes[where]\n    return Keyframe.interpolate(before, after, frame)\n  }\n}\n\nexport default AnimatableItem\n","import { observable } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Circle extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get RADIUS() { return 10 }\n\n  @observable _radius = Circle.RADIUS\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      radius: this.radius,\n    })\n  }\n\n  get radius() { return this._radius }\n  set radius(value) {\n    // TODO: update this value using item.bounds and scale\n    this._radius = value\n    this.recreate()\n  }\n\n  onCreate(itemProps) {\n    const { x, y } = this.position\n    new this.paper.Path.Circle({\n      ...itemProps,\n      center: [this.absolute(x), this.absolute(y, 'height')],\n      radius: this.absolute(this.radius) / 2,\n    })\n  }\n}\n\nexport default Circle\n","import { observable } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Rectangle extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get WIDTH() { return 10 }\n  static get HEIGHT() { return 10 }\n  static get RADIUS() { return 0 }\n\n  @observable _width = Rectangle.WIDTH\n  @observable _height = Rectangle.HEIGHT\n  @observable _radius = Rectangle.RADIUS\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      width: this.width,\n      height: this.height,\n      radius: this.radius,\n    })\n  }\n\n  get width() { return this._width }\n  get height() { return this._height }\n  get radius() { return this._radius }\n\n  set width(value) {\n    // TODO: update this value using item.bounds and scale\n    this._width = value\n    this.recreate()\n  }\n\n  set height(value) {\n    // TODO: update this value using item.bounds and scale\n    this._height = value\n    this.recreate()\n  }\n\n  set radius(value) {\n    // TODO: update this value using item.bounds and scale\n    this._radius = value\n    this.recreate()\n  }\n\n  onCreate(itemProps) {\n    const { x, y } = this.position\n    const absX = this.absolute(x)\n    const absY = this.absolute(y, 'height')\n    const absWidth = this.absolute(this.width)\n    const absHeight = this.absolute(this.height)\n\n    new this.paper.Path.Rectangle({\n      ...itemProps,\n      point: [absX - (absWidth / 2), absY - (absHeight / 2)],\n      size: [absWidth, absHeight],\n      radius: (this.radius / 100) * (Math.max(absWidth, absHeight) / 2),\n    })\n  }\n}\n\nexport default Rectangle\n","import { observable, action } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Text extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get FONT_SIZE() { return 20 }\n\n  static get OBSERVABLES() {\n    return [...AnimatableItem.OBSERVABLES, 'fontSize']\n  }\n\n  @observable _content = 'Text Object'\n  @observable _fontSize = Text.FONT_SIZE\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      content: this.content,\n      fontSize: this.fontSize,\n    })\n  }\n\n  get content() { return this._content }\n  get fontSize() { return this._fontSize }\n\n  set content(value) {\n    this.item.content = value\n    this._content = value\n    this.resetPositionFromSizeChange()\n  }\n\n  set fontSize(value) {\n    this.item.fontSize = this.absolute(value) / 5\n    this._fontSize = value\n    this.resetPositionFromSizeChange()\n  }\n\n  @action resetPositionFromSizeChange() {\n    const { x, y } = this.position\n    this.position = { x, y }\n    this.canvas.draw()\n  }\n\n  onCreate(itemProps) {\n    new this.paper.PointText({\n      ...itemProps,\n      content: this.content,\n    })\n    this.fontSize = this.fontSize // placed here to eliminate duplicate logic\n    this.resetPositionFromSizeChange()\n  }\n}\n\nexport default Text\n","import Circle from './Circle'\nimport Rectangle from './Rectangle'\nimport Text from './Text'\n\nconst items = {\n  Circle,\n  Rectangle,\n  Text,\n}\n\nexport default items\n","import { observable, action } from 'mobx'\n\nclass Animation {\n  static get FIRST() { return 1 }\n  static get PLAYBACK_MODES() { return ['LOOP', 'ONCE'] }\n\n  @observable frames\n  @observable firstFrame\n  @observable lastFrame\n  @observable fps\n  @observable now\n  @observable playing\n  @observable sync\n  @observable requestId\n  @observable mode\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.frames = 100\n    this.firstFrame = Animation.FIRST\n    this.lastFrame = 100\n    this.fps = 30\n    this.now = this.firstFrame\n    this.playing = false\n    this.sync = 0\n    this.requestId = null\n    this.mode = 'LOOP'\n  }\n\n  toJSON() {\n    return ({\n      frames: this.frames,\n      firstFrame: this.firstFrame,\n      lastFrame: this.lastFrame,\n      fps: this.fps,\n      mode: this.mode,\n    })\n  }\n\n  @action setLength(length) {\n    this.frames = length\n    if (length < this.lastFrame) {\n      this.lastFrame = length\n    }\n  }\n\n  @action setIn = (f) => {\n    if (f < Animation.FIRST || f > this.frames) return\n    this.firstFrame = f\n    if (this.now < f) {\n      this.goToFrame(f)\n    }\n  }\n\n  @action setOut = (f) => {\n    if (f < Animation.FIRST || f > this.frames) return\n    this.lastFrame = f\n    if (this.now > f) {\n      this.goToFrame(f)\n    }\n  }\n\n  nextFrame = () => {\n    const later = this.now + 1\n    if (later > this.lastFrame) {\n      if (this.mode === 'LOOP') return this.firstFrame\n      return null\n    }\n    return later\n  }\n\n  prevFrame = () => {\n    const earlier = this.now - 1\n    if (earlier < this.firstFrame) {\n      if (this.mode === 'LOOP') return this.lastFrame\n      return null\n    }\n    return earlier\n  }\n\n  @action play = () => {\n    if (this.nextFrame() === null) return\n    this.playing = true\n    this.animateAtRate(() => {\n      const nextFrame = this.nextFrame()\n      if (nextFrame === null) return this.pause()\n      this.now = nextFrame\n    })\n  }\n\n  @action pause = () => {\n    this.playing = false\n    if (this.requestId) cancelAnimationFrame(this.requestId)\n  }\n\n  @action goToFrame = (frame) => {\n    this.now = frame\n  }\n\n  @action goToFirst = () => {\n    this.goToFrame(this.firstFrame)\n  }\n\n  @action goToLast = () => {\n    this.goToFrame(this.lastFrame)\n  }\n\n  @action goToNext = () => {\n    const nextFrame = this.nextFrame()\n    if (nextFrame === null) return\n    this.goToFrame(nextFrame)\n  }\n\n  @action goToPrev = () => {\n    const prevFrame = this.prevFrame()\n    if (prevFrame === null) return\n    this.goToFrame(prevFrame)\n  }\n\n  @action animateAtRate = (func) => {\n    const interval = 1000 / this.fps\n    let then = Date.now()\n\n    const loop = () => {\n      if (this.playing === false) return\n      this.requestId = requestAnimationFrame(loop)\n      const now = Date.now()\n      const delta = now - then\n      if (delta >= interval) {\n        then = now - (delta % interval)\n        this.sync = Math.round(delta - interval - (delta % interval))\n        func()\n      }\n    }\n    loop()\n  }\n}\n\nexport default Animation\n","import React from 'react'\n\nconst Grid = ({ children, ...style }) => (\n  <div style={{ display: 'grid', ...style }}>\n    {children}\n  </div>\n)\n\nexport default Grid\n","const cssContext = require.context(\n  '!!file-loader?name=[name].[ext]!.',\n  true,\n  /\\.(css)$/\n)\n\ncssContext.keys().forEach(cssContext)\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport items from '../prototypes/items'\n\n@observer\nclass ToolController extends Component {\n  choose = (event) => {\n    event.preventDefault()\n    this.props.setTool(event.currentTarget.id)\n  }\n\n  addCircle = () => {\n    const { existing } = this.props\n    const circle = new items.Circle(`circle-${Object.keys(existing).length}`)\n    this.props.add(circle)\n  }\n\n  addRectangle = () => {\n    const { existing } = this.props\n    const rect = new items.Rectangle(`rect-${Object.keys(existing).length}`)\n    this.props.add(rect)\n  }\n\n  addText = () => {\n    const { existing } = this.props\n    const text = new items.Text(`text-${Object.keys(existing).length}`)\n    this.props.add(text)\n  }\n\n  render() {\n    const { tool } = this.props\n\n    return (\n      <div style={{ display: 'flex', padding: '10px 10px 0px 10px' }}>\n        <button\n          type=\"button\"\n          id=\"SETTINGS\"\n          onClick={this.choose}\n          {...(tool === 'SETTINGS' ? { primary: 'true' } : {})}\n        >\n          <div>&#9776;</div>\n        </button>\n        <button\n          type=\"button\"\n          id=\"CLEAR\"\n          onClick={this.choose}\n        >\n          <div>&#10007;</div>\n        </button>\n        <button\n          type=\"button\"\n          id=\"SELECT\"\n          onClick={this.choose}\n          {...(tool === 'SELECT' ? { primary: 'true' } : {})}\n        >\n          <div style={{ transform: 'rotate(-135deg)' }}>&#10148;</div>\n        </button>\n        {/* <button\n          type=\"button\"\n          id=\"DRAW\"\n          onClick={this.choose}\n          {...(tool === 'DRAW' ? { primary: 'true' } : {})}\n        >\n          \n        </button> */}\n\n        <button type=\"button\" onClick={this.addCircle}>+ Circle</button>\n        <button type=\"button\" onClick={this.addRectangle}>+ Rectangle</button>\n        <button type=\"button\" onClick={this.addText}>+ Text</button>\n      </div>\n    )\n  }\n}\n\nexport default ToolController\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass IntegerInput extends Component {\n  state = {\n    localValue: 0,\n  }\n\n  componentDidMount() {\n    const { value } = this.props\n    if (value !== this.state.localValue) {\n      this.setState({ localValue: value })\n    }\n  }\n\n  onChange = (event) => {\n    this.setState({ localValue: event.target.value })\n  }\n\n  onBlur = () => {\n    const { value, setValue } = this.props\n    const { localValue } = this.state\n\n    const possibleInt = parseInt(localValue)\n    let result = value\n    if (Number.isInteger(possibleInt)) {\n      result = possibleInt\n    }\n\n    setValue(result)\n    this.setState({ localValue: result })\n  }\n\n  handleKeyDown = (event) => {\n    const { key, shiftKey } = event\n    if (key === 'ArrowUp' && shiftKey) {\n      this.incrementBy(10)\n    } else if (key === 'ArrowUp') {\n      this.incrementBy(1)\n    } else if (key === 'ArrowDown' && shiftKey) {\n      this.decrementBy(10)\n    } else if (key === 'ArrowDown') {\n      this.decrementBy(1)\n    }\n  }\n\n  changeBy = operation => (amount) => {\n    const { value, setValue } = this.props\n    const next = operation(value, amount)\n    setValue(next)\n    this.setState({ localValue: next })\n  }\n\n  // eslint-disable-next-line\n  incrementBy = this.changeBy((a, b) => a + b)\n  decrementBy = this.changeBy((a, b) => a - b)\n\n  render() {\n    const { localValue } = this.state\n    return (\n      <input\n        type=\"text\"\n        style={{ width: '60px', marginRight: '20px', textAlign: 'center' }}\n        value={localValue}\n        onChange={this.onChange}\n        onKeyDown={this.handleKeyDown}\n        onBlur={this.onBlur}\n      />\n    )\n  }\n}\n\nexport default IntegerInput\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass TextInput extends Component {\n  onChange = (event) => {\n    const { setValue } = this.props\n    setValue(event.target.value)\n  }\n\n  render() {\n    const { value } = this.props\n    return (\n      <input\n        type=\"text\"\n        style={{ width: '100%', marginRight: '20px', textAlign: 'left' }}\n        value={value}\n        onChange={this.onChange}\n      />\n    )\n  }\n}\n\nexport default TextInput\n","import React, { useRef } from 'react'\n\nconst style = {\n  container: {\n    position: 'fixed',\n    zIndex: 100,\n    left: 0,\n    top: 0,\n    width: '100%',\n    height: '100%',\n    overflow: 'auto',\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n  },\n  body: {\n    backgroundColor: '#fefefe',\n    margin: '15% auto',\n    border: '1px solid #888',\n    width: '80%',\n  },\n  content: {\n    padding: '16px',\n  },\n}\n\nconst Modal = ({ children, open, handleClose }) => {\n  const clickawayEl = useRef(null)\n\n  const onClickaway = (event) => {\n    if (clickawayEl.current.contains(event.target)) return\n    handleClose()\n  }\n\n  return (\n    open === false ? null : (\n      <div style={style.container} onClick={onClickaway}>\n        <div ref={clickawayEl} style={style.body}>\n          <div style={style.content}>{children}</div>\n        </div>\n      </div>\n    )\n  )\n}\n\nexport default Modal\n","// encapsulates ValueEditor, implements editing the paper properties of an AnimatibleItem\n\nimport React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport IntegerInput from '../components/IntegerInput'\nimport TextInput from '../components/TextInput'\n\n@observer\nclass PropertyEditor extends Component {\n  propertySetter = property => (value) => {\n    const { item, now } = this.props\n\n    if (item.keyframes[property] && item.keyframes[property].length) {\n      const existingKeyframe = item.keyframes[property].find(keyframe => keyframe.frame === now)\n      if (existingKeyframe) {\n        existingKeyframe.value = value\n      } else {\n        item.addKey(`${property}`, now, value)\n      }\n    } else {\n      item[property] = value\n    }\n  }\n\n  classControls() {\n    const { item } = this.props\n    const itemClass = item.constructor.name\n\n    if (itemClass === 'Circle') {\n      return (\n        <React.Fragment>\n          <label>Radius</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.radius} setValue={this.propertySetter('radius')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n\n    if (itemClass === 'Rectangle') {\n      return (\n        <React.Fragment>\n          <label>Size</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.width} setValue={this.propertySetter('width')} />\n            <IntegerInput value={item.height} setValue={this.propertySetter('height')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n\n    if (itemClass === 'Text') {\n      return (\n        <React.Fragment>\n          <label>Content</label>\n          <div style={{ display: 'flex' }}>\n            <TextInput value={item.content} setValue={this.propertySetter('content')} />\n          </div>\n          <label>Font Size</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.fontSize} setValue={this.propertySetter('fontSize')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n  }\n\n  render() {\n    const { item } = this.props\n\n    if (item === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          Select an Item on the Canvas.\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <h4>{item.key}</h4>\n        <label>Position</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.x} setValue={this.propertySetter('x')} />\n          <IntegerInput value={item.y} setValue={this.propertySetter('y')} />\n        </div>\n\n        <label>Scale</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.scale} setValue={this.propertySetter('scale')} />\n        </div>\n\n        <label>Rotation</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.rotation} setValue={this.propertySetter('rotation')} />\n        </div>\n\n        {this.classControls()}\n      </div>\n    )\n  }\n}\n\nexport default PropertyEditor\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Modal from '../components/Modal'\n\n@observer\nclass ProjectSettings extends Component {\n  setName = (event) => {\n    const { store } = this.props\n    store.project.setName(event.target.value)\n  }\n\n  setLength = (event) => {\n    const { store } = this.props\n    const length = parseInt(event.target.value)\n    store.animation.setLength(length)\n  }\n\n  setColor = (event) => {\n    const { store } = this.props\n    store.canvas.color = event.target.value\n  }\n\n  closeModal = () => this.props.store.canvas.setTool('SELECT')\n\n  render() {\n    const { store } = this.props\n\n    return (\n      <Modal open={store.mode.settings} handleClose={this.closeModal}>\n        <h3>Project Settings</h3>\n\n        <label>Project Name</label>\n        <input type=\"text\" value={store.project.name} onChange={this.setName} />\n\n        <label>Animation Length</label>\n        <input type=\"number\" step=\"1\" value={store.animation.frames} onChange={this.setLength} />\n\n        <label>Canvas Background</label>\n        <select value={store.canvas.color} onChange={this.setColor}>\n          <option value=\"#000000\">Black</option>\n          <option value=\"#ffffff\">White</option>\n        </select>\n\n        <div style={{ display: 'flex', flexDirection: 'row-reverse' }}>\n          <button type=\"button\" onClick={this.closeModal}>Close</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default ProjectSettings\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Modal from '../components/Modal'\n\n@observer\nclass ClearProject extends Component {\n  closeModal = () => this.props.store.canvas.setTool('SELECT')\n\n  render() {\n    const { store } = this.props\n    const { mode, project, reset } = store\n\n    return (\n      <Modal open={mode.clear} handleClose={this.closeModal}>\n        <h3>Remove Project?</h3>\n\n        <p>\n          You are about to remove&nbsp;\n          <strong>{project.name}</strong>\n          &nbsp;from your workspace, and start from scratch.\n          Are you sure you want to do this?\n        </p>\n\n        <div style={{ display: 'flex', justifyContent: 'flex-end' }}>\n          <button type=\"button\" onClick={this.closeModal}>Cancel</button>\n          <button type=\"button\" onClick={reset}>Remove</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default ClearProject\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\nimport { autorun } from 'mobx'\n\nimport Viewer from './Viewer'\nimport ToolController from './ToolController'\nimport PropertyEditor from './PropertyEditor'\nimport ProjectSettings from './ProjectSettings'\nimport ClearProject from './ClearProject'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nimport items from '../prototypes/items'\nimport Keyframe from '../prototypes/Keyframe'\n\n@observer\nclass BuildMode extends Component {\n  state = {\n    ready: false,\n    inputItemsExist: false,\n  }\n\n  autorunDisposer\n\n  componentDidMount() {\n    const { canvas, project } = this.props.store\n    const container = document.getElementById('build-container')\n    setTimeout(() => {\n      const width = Math.round(container.clientWidth) - 20\n      const height = Math.round((9 / 16) * width)\n      canvas.setSize(width, height)\n    }, 1)\n\n    if (canvas.tool === 'SELECT') {\n      setTimeout(() => {\n        canvas.setTool(undefined)\n        canvas.setTool('SELECT')\n      }, 20)\n    }\n\n    this.autorunDisposer = autorun(() => {\n      this.setState({ inputItemsExist: Boolean(project.inputItems) })\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const prevInputItemsExist = prevState.inputItemsExist\n    const { canvas, project } = this.props.store\n    const { ready, inputItemsExist } = this.state\n    if (\n      !project.inputBuilt &&\n      (\n        (ready && !prevInputItemsExist && inputItemsExist) ||\n        (inputItemsExist && !prevState.ready && ready)\n      )\n    ) {\n      Object.entries(project.inputItems).forEach(([itemKey, itemObj]) => {\n        const { class: itemClass, keyframes, ...properties } = itemObj\n\n        const animatable = new items[itemClass](itemKey)\n        canvas.add(animatable)\n\n        const inputKeyframes = Object.entries(keyframes)\n          .reduce((accum, [keyframeProp, keyframeList]) => {\n            /* eslint no-param-reassign: 0 */\n            accum[keyframeProp] = keyframeList.map(Keyframe.fromJSON)\n            return accum\n          }, {})\n        animatable.keyframes = {\n          ...this.keyframes,\n          ...inputKeyframes,\n        }\n\n        Object.entries(properties).forEach(([key, value]) => {\n          animatable[key] = value\n        })\n      })\n\n      project.inputBuilt = true\n    }\n  }\n\n  componentWillUnmount() {\n    const { project, canvas } = this.props.store\n    canvas.selectOff()\n    project.clear()\n    this.autorunDisposer()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n    this.setState({ ready: true })\n  }\n\n  add = (item) => {\n    const { canvas } = this.props.store\n    canvas.add(item)\n  }\n\n  render() {\n    const { canvas, animation } = this.props.store\n    const { ready } = this.state\n    return (\n      <React.Fragment>\n        <ProjectSettings store={this.props.store} />\n        <ClearProject store={this.props.store} />\n        <Grid\n          gridTemplateRows=\"auto 60px\"\n          gridTemplateColumns=\"auto 340px\"\n        >\n          <GridItem gridArea=\"1 / 1 / 1 / 2\" id=\"build-container\" padding=\"10px\" alignSelf=\"center\">\n            <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n          </GridItem>\n          <GridItem gridArea=\"1 / 2 / 1 / 3\" backgroundColor=\"rgb(210, 210, 210)\">\n            <PropertyEditor item={canvas.selected} now={animation.now} />\n          </GridItem>\n          <GridItem gridArea=\"2 / 1 / 2 / 3\" backgroundColor=\"rgb(180, 180, 180)\">\n            { ready && (\n              <ToolController\n                existing={canvas.animatables}\n                add={this.add}\n                tool={canvas.tool}\n                setTool={canvas.setTool}\n              />\n            )}\n          </GridItem>\n        </Grid>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default BuildMode\n","const findPointWithLines = (points, t) => {\n  if (points.length === 1) {\n    return points[0]\n  }\n\n  const newPoints = []\n  for (let i = 0; i < points.length - 1; i += 1) {\n    const currPoint = points[i]\n    const nextPoint = points[i + 1]\n\n    const x = (1 - t) * currPoint.x + t * nextPoint.x\n    const y = (1 - t) * currPoint.y + t * nextPoint.y\n\n    newPoints.push({ x, y })\n  }\n\n  return findPointWithLines(newPoints, t)\n}\n\nconst bezierPoints = ({ x2, x3, y2, y3 }, segments) => {\n  /* x2, and x3 are the X values from the 2nd and 3rd points for a bezier\n      definition. For this use case, they must be between 0 - 1.\n  */\n  if (x2 > 1 || x2 < 0 || x3 > 1 || x3 < 0) {\n    throw Error('This bezier curve requires control values between 0 & 1')\n  }\n\n  const points = []\n  const step = 1 / segments\n\n  for (let i = 0; i <= segments; i += 1) {\n    const time = i * step\n    const point = findPointWithLines([\n      { x: 0, y: 0 },\n      { x: x2, y: y2 },\n      { x: x3, y: y3 },\n      { x: 1, y: 1 },\n    ], time)\n\n    points.push(point)\n  }\n\n  return points\n}\n\nconst lerp = (x1, y1, x2, y2, xInterp) => (\n  (((xInterp - x1) * (y2 - y1)) / (x2 - x1)) + y1\n)\n\nconst bezierApproximation = (handlePoints, samples) => {\n  if (samples <= 0) {\n    throw Error('Bezier approximation requires at least 1 sample request')\n  }\n\n  const granularity = 10 ** (Math.round(Math.log10(samples)) + 1)\n  const points = bezierPoints(handlePoints, granularity)\n\n  const y = (x) => {\n    const afterPointIndex = points.findIndex(point => point.x > x)\n    const before = points[afterPointIndex - 1]\n    const after = points[afterPointIndex]\n    return lerp(before.x, before.y, after.x, after.y, x)\n  }\n\n  return { y }\n}\n\nexport default bezierApproximation\n","import { observable } from 'mobx'\n\nimport Handle from './Handle'\nimport bezierApproximation from '../util/bezierApproximation'\n\nclass Keyframe {\n  static get OBSERVABLES() {\n    return ['frame', 'value', 'handleIn', 'handleOut']\n  }\n\n  @observable frame\n  @observable value\n  @observable handleIn\n  @observable handleOut\n\n  constructor(frame, value) {\n    this.frame = frame\n    this.value = value\n    this.handleIn = new Handle('IN')\n    this.handleOut = new Handle('OUT')\n  }\n\n  toJSON() {\n    return ({\n      frame: this.frame,\n      value: this.value,\n      handleIn: this.handleIn.toJSON(),\n      handleOut: this.handleOut.toJSON(),\n    })\n  }\n\n  static fromJSON(input) {\n    const { frame, value, handleIn, handleOut } = input\n    const keyframe = new Keyframe(frame, value)\n    keyframe.handleIn.influence = handleIn.influence\n    keyframe.handleIn.distance = handleIn.distance\n    keyframe.handleOut.influence = handleOut.influence\n    keyframe.handleOut.distance = handleOut.distance\n    return keyframe\n  }\n\n  static sort = (a, b) => (a.frame - b.frame)\n\n  static interpolate = (k1, k2, frame) => {\n    // TODO: cache the curve creation to reduce computation\n    const curve = bezierApproximation(\n      {\n        x2: k1.handleOut.position.x,\n        y2: k1.handleOut.position.y,\n        x3: k2.handleIn.position.x,\n        y3: k2.handleIn.position.y,\n      },\n      k2.frame - k1.frame - 1\n    )\n\n    const timeRatio = (frame - k1.frame) / (k2.frame - k1.frame)\n    const valueRatio = curve.y(timeRatio)\n    const interpolated = ((k2.value - k1.value) * valueRatio) + k1.value\n\n    return interpolated\n  }\n}\n\nexport default Keyframe\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass Canvas extends Component {\n  componentDidMount() {\n    this.testForAvailability()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.width === undefined) {\n      this.testForAvailability()\n    }\n  }\n\n  testForAvailability() {\n    const { width, hasSize } = this.props\n    if (width !== undefined) {\n      hasSize()\n    }\n  }\n\n  render() {\n    const { id, width, height } = this.props\n    if (width === undefined) return null\n    return (\n      <canvas\n        style={{ display: 'block' }}\n        id={id}\n        width={width}\n        height={height}\n      />\n    )\n  }\n}\n\nexport default Canvas\n","/* encapsulates Mode, implements:\n\n  | Viewer     | ExportEditor   |\n  |            |                |\n   ------------|                |\n  | Format     |                |\n  | Controller |                |\n\n*/\n\nimport React, { Component } from 'react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nclass ExportMode extends Component {\n  loadThenBuild = (event) => {\n    const { project, mode } = this.props.store\n    return project.loadFromFile(event, () => mode.set('BUILD'))\n  }\n\n  saveThenDownload = () => {\n    const { project } = this.props.store\n    project.download(project.save())\n  }\n\n  render() {\n    const { project } = this.props.store\n\n    return (\n      <Grid\n        gridTemplateRows=\"1fr 1fr 1fr\"\n        gridTemplateColumns=\"auto\"\n        // alignItems=\"center\"\n        justifyItems=\"center\"\n      >\n        {/* <GridItem padding=\"10px\">\n          <h3 style={{ padding: '10px', color: 'darkgray' }}>\n            Feature under construction.\n          </h3>\n        </GridItem> */}\n        <GridItem alignSelf=\"end\">\n          <button type=\"button\" onClick={this.saveThenDownload}>&#x21e9; Save Project to File</button>\n        </GridItem>\n        <GridItem alignSelf=\"center\">\n          <label htmlFor=\"file-button\" style={{ display: 'block', width: '300px' }}>&#x21aa; Load Project from File</label>\n          <input type=\"file\" id=\"file-button\" onChange={this.loadThenBuild} style={{ width: '300px' }} />\n        </GridItem>\n        <GridItem>\n          <button type=\"button\" onClick={project.publish}>&#x2912; Publish Project to Gallery</button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default ExportMode\n","module.exports = __webpack_public_path__ + \"bare.min.css\";","import React, { Component } from 'react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nclass ModeController extends Component {\n  navigate = (event) => {\n    event.preventDefault()\n    const { mode } = this.props\n    mode.set(event.target.textContent.toUpperCase())\n  }\n\n  render() {\n    const { current } = this.props.mode\n    return (\n      <Grid gridTemplateColumns=\"1fr 1fr 1fr 1fr\" borderBottom=\"1px solid rgb(230, 230, 230)\">\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'BUILD' ? { primary: 'true' } : {})}\n          >\n            Build\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'ANIMATE' ? { primary: 'true' } : {})}\n          >\n            Animate\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'VIEW' ? { primary: 'true' } : {})}\n          >\n            View\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'EXPORT' ? { primary: 'true' } : {})}\n          >\n            Export\n          </button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default ModeController\n","import paper from 'paper'\n\nimport Handle from './Handle'\n\nclass HandleEditor {\n  constructor(trueWidth, keyframeBefore, keyframeAfter, onMove) {\n    this.trueWidth = trueWidth\n    this.keyframeBefore = keyframeBefore\n    this.keyframeAfter = keyframeAfter\n    this.onMove = onMove\n    this.paper = new paper.PaperScope()\n\n    this.element = undefined\n  }\n\n  attatchTo = (id) => {\n    const element = document.getElementById(id)\n    this.element = element\n    this.paper.setup(element)\n  }\n\n  destroy() {\n    if (this.paper.project) {\n      this.paper.project.clear()\n      this.paper.project.remove()\n    }\n  }\n\n  init() {\n    // Assumes Width & Height are identical\n    this.padding = 10\n    this.width = this.trueWidth - (this.padding * 2)\n    const { width, padding } = this\n\n    const topLeft = [padding, padding]\n    const topRight = [width + padding, padding]\n    const bottomLeft = [padding, width + padding]\n    // const bottomRight = [width, width + padding]\n    const spacing = width / Handle.STEP\n    const center = this.trueWidth / 2\n\n    // Background\n    new this.paper.Path.Rectangle({\n      topLeft: [0, 0],\n      bottomRight: [this.trueWidth, this.trueWidth],\n      fillColor: 'rgb(210, 210, 210)',\n    })\n\n    // Gridlines\n    const gridline = new this.paper.SymbolDefinition(\n      new this.paper.Path.Line({\n        from: [0, 0],\n        to: [0, this.trueWidth],\n        // strokeColor: '#324252',\n        strokeColor: 'rgb(180, 180, 180)',\n        strokeWidth: 2,\n      })\n    )\n    for (let i = 0; i <= Handle.STEP; i += 1) {\n      const offset = padding + 0 + (spacing * i)\n      gridline.place(new this.paper.Point(offset, center))\n      const offAxis = gridline.place(new this.paper.Point(center, offset))\n      offAxis.rotate(90)\n    }\n\n    // Value Interpolation Curve\n    this.curve = new this.paper.Path.Line({\n      // strokeColor: '#2176ff',\n      strokeColor: 'rgb(30, 155, 255)',\n      strokeWidth: 2,\n      from: new this.paper.Point(bottomLeft),\n      to: new this.paper.Point(topRight),\n    })\n    this.setVisualCurveHandles()\n\n    // Handle Strings\n    const stringStyle = {\n      // strokeColor: '#2176ff',\n      strokeColor: 'rgb(30, 155, 255)',\n      strokeWidth: 2,\n    }\n    const handleBeforeString = new this.paper.Path.Line({\n      ...stringStyle,\n      from: bottomLeft,\n      to: this.handleBefore(),\n    })\n    const handleAfterString = new this.paper.Path.Line({\n      ...stringStyle,\n      from: this.handleAfter(),\n      to: topRight,\n    })\n\n    // Handle Grips\n    const handleMovable = new this.paper.SymbolDefinition(\n      new this.paper.Path.Circle({\n        point: topLeft,\n        radius: 6,\n        // strokeColor: '#2176ff',\n        strokeColor: 'rgb(30, 155, 255)',\n        strokeWidth: 2,\n        fillColor: new this.paper.Color(1, 0.01),\n      })\n    )\n    const handleStationary = new this.paper.SymbolDefinition(\n      new this.paper.Path.Rectangle({\n        point: [100, 100],\n        size: [10, 10],\n        // fillColor: '#2176ff',\n        fillColor: 'rgb(30, 155, 255)',\n      })\n    )\n    handleStationary.place(bottomLeft)\n    handleStationary.place(topRight)\n    const handleBefore = handleMovable.place(this.handleBefore())\n    const handleAfter = handleMovable.place(this.handleAfter())\n\n    // Handle Events\n    handleBefore.onMouseEnter = () => {\n      this.element.style.cursor = 'pointer'\n    }\n    handleBefore.onMouseLeave = () => {\n      this.element.style.cursor = 'default'\n    }\n    handleBefore.onMouseDrag = (event) => {\n      this.element.style.cursor = 'pointer'\n      const travelled = event.point.subtract(handleBefore.position)\n\n      const xChange = Math.abs(travelled.x) >= (spacing / 2)\n      const yChange = Math.abs(travelled.y) >= (spacing / 2)\n      if (xChange || yChange) {\n        const xSign = Math.sign(travelled.x)\n        const ySign = Math.sign(travelled.y)\n        const newPosition = handleBefore.position.add({\n          x: xSign * spacing * xChange,\n          y: ySign * spacing * yChange,\n        })\n\n        handleBefore.position = newPosition\n        handleBeforeString.lastSegment.point = newPosition\n        this.onMove('OUT', {\n          influence: xSign * Handle.STEP * xChange,\n          distance: -1 * ySign * Handle.STEP * yChange,\n        })\n        this.setVisualCurveHandles()\n      }\n    }\n    handleBefore.onMouseUp = () => {\n      this.element.style.cursor = 'default'\n    }\n\n    handleAfter.onMouseEnter = () => {\n      this.element.style.cursor = 'pointer'\n    }\n    handleAfter.onMouseLeave = () => {\n      this.element.style.cursor = 'default'\n    }\n    handleAfter.onMouseDrag = (event) => {\n      this.element.style.cursor = 'pointer'\n      const travelled = event.point.subtract(handleAfter.position)\n\n      const xChange = Math.abs(travelled.x) >= (spacing / 2)\n      const yChange = Math.abs(travelled.y) >= (spacing / 2)\n      if (xChange || yChange) {\n        const xSign = Math.sign(travelled.x)\n        const ySign = Math.sign(travelled.y)\n        const newPosition = handleAfter.position.add({\n          x: xSign * spacing * xChange,\n          y: ySign * spacing * yChange,\n        })\n\n        handleAfter.position = newPosition\n        handleAfterString.firstSegment.point = newPosition\n        this.onMove('IN', {\n          influence: -1 * xSign * Handle.STEP * xChange,\n          distance: ySign * Handle.STEP * yChange,\n        })\n        this.setVisualCurveHandles()\n      }\n    }\n    handleAfter.onMouseUp = () => {\n      this.element.style.cursor = 'default'\n    }\n  }\n\n\n  handleBefore = () => (\n    this.absoluteHandlePosition(this.keyframeBefore.handleOut.position)\n  )\n\n  handleAfter = () => (\n    this.absoluteHandlePosition(this.keyframeAfter.handleIn.position)\n  )\n\n  absoluteHandlePosition(handlePosition) {\n    return ([\n      handlePosition.x * this.width + this.padding,\n      // Compensates for 4th quadrant cartesian system\n      this.width - (handlePosition.y * this.width) + this.padding,\n    ])\n  }\n\n  setVisualCurveHandles() {\n    if (this.curve) {\n      this.curve.firstSegment.handleOut = new this.paper.Point(\n        this.keyframeBefore.handleOut.influence * this.width / Handle.MAX,\n        -1 * this.keyframeBefore.handleOut.distance * this.width / Handle.MAX\n      )\n      this.curve.lastSegment.handleIn = new this.paper.Point(\n        -1 * this.keyframeAfter.handleIn.influence * this.width / Handle.MAX,\n        this.keyframeAfter.handleIn.distance * this.width / Handle.MAX\n      )\n    }\n  }\n}\n\nexport default HandleEditor\n","import React from 'react'\nimport { observer } from 'mobx-react'\n\nimport Canvas from '../components/Canvas'\n\nimport HandleEditorInstance from '../prototypes/HandleEditor'\n\n@observer\nclass HandleEditor extends React.Component {\n  state = {}\n\n  handleEditor\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.keyframeKey !== undefined && prevProps.keyframeKey !== this.props.keyframeKey) {\n      if (this.handleEditor) this.handleEditor.destroy()\n      this.buildHandleEditorCanvas()\n    }\n  }\n\n  handleEditorHasSize = () => {\n    this.buildHandleEditorCanvas()\n  }\n\n  buildHandleEditorCanvas = () => {\n    const { width, keyframeBefore, keyframeAfter, onMove } = this.props\n\n    if (keyframeBefore && keyframeAfter) {\n      this.handleEditor = new HandleEditorInstance(width, keyframeBefore, keyframeAfter, onMove)\n      this.handleEditor.attatchTo('handle-editor')\n      this.handleEditor.init()\n    }\n  }\n\n  render() {\n    const { width, keyframeKey, keyframeBefore, keyframeAfter } = this.props\n\n    if (keyframeKey === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          Select a Keyframe on the Timeline.\n        </h3>\n      )\n    }\n\n    if (keyframeBefore && !keyframeAfter) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          <i>Selected tail Keyframe has no handle relationships.</i>\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <Canvas\n          id=\"handle-editor\"\n          width={width}\n          height={width}\n          hasSize={this.handleEditorHasSize}\n        />\n      </div>\n    )\n  }\n}\n\nexport default HandleEditor\n","import React from 'react'\nimport { observer } from 'mobx-react'\nimport paper from 'paper'\n\nimport Canvas from '../components/Canvas'\n\n@observer\nclass KeyframeEditor extends React.Component {\n  state = {\n    previouslyClickedKeyframe: undefined,\n  }\n\n  paper = new paper.PaperScope()\n  element\n\n  componentDidMount() {\n    document.addEventListener('keyup', this.handleKeyUp)\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.item !== undefined &&\n      this.props.item !== undefined &&\n      prevProps.item.key !== this.props.item.key\n    ) {\n      this.rebuild()\n    }\n\n    if (prevProps.now !== this.props.now) {\n      this.buildPlayhead()\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keyup', this.handleKeyUp)\n  }\n\n  keyframeEditorHasSize = () => {\n    this.buildKeyframeEditorCanvas()\n  }\n\n  handleKeyframeClick = (event) => {\n    event.stopPropagation()\n    const { currentTarget } = event\n\n    const { onSelect } = this.props\n    const { previouslyClickedKeyframe } = this.state\n\n    if (previouslyClickedKeyframe) {\n      previouslyClickedKeyframe.strokeWidth = 0\n      previouslyClickedKeyframe.shadowColor.alpha = 0\n    }\n    currentTarget.strokeWidth = 1\n    currentTarget.shadowColor.alpha = 0.3\n    onSelect(currentTarget.name)\n    this.setState({ previouslyClickedKeyframe: currentTarget })\n  }\n\n  handleKeyUp = (event) => {\n    const { key } = event\n    const { item, keyframeKey, keyframe, onSelect } = this.props\n    if (key === 'Backspace' || key === 'Delete') {\n      event.preventDefault()\n\n      const keyframeProp = keyframeKey.split('.')[1]\n      onSelect(undefined)\n      item.removeKey(keyframeProp, keyframe.frame)\n      this.rebuild()\n    }\n  }\n\n  buildKeyframeEditorCanvas = () => {\n    const { item } = this.props\n    this.element = document.getElementById('keyframe-editor')\n    this.paper.setup(this.element)\n\n    const { verticalSpacing, timelineStart, timelineEnd, timelineStep } = this.timelineMath()\n    let placementIndex = 0\n\n    const { playheadLine } = this.buildPlayhead()\n    const newKeyframeItems = []\n\n    Object.entries(item.keyframes).forEach(([prop, list]) => {\n      let propName = prop\n      const placing = placementIndex * verticalSpacing + verticalSpacing\n\n      if (prop === 'y') return // Interpret `x` & `y` at the same time\n      if (prop === 'x') {\n        propName = 'position'\n      }\n\n      // Draw Timelines\n      new this.paper.PointText({\n        point: [0, placing],\n        content: propName,\n        fillColor: 'black',\n        fontSize: 14,\n      })\n      const timelineHover = new this.paper.Path.Line({\n        name: 'timelineHover',\n        from: [timelineStart + 5, placing - 5],\n        to: [timelineEnd, placing - 5],\n        strokeColor: 'rgba(180, 180, 180, 1)',\n        strokeWidth: 40,\n      })\n      const timeline = new this.paper.Path.Line({\n        from: [timelineStart + 5, placing - 5],\n        to: [timelineEnd, placing - 5],\n        strokeColor: 'lightgrey',\n        strokeWidth: 4,\n      })\n\n      const newKeyframeRect = new this.paper.Path.Rectangle({\n        name: 'newKeyframeRect',\n        point: [0, placing - 10],\n        size: [10, 10],\n        radius: 3,\n        fillColor: 'rgba(31, 155, 255, 0.5)',\n        rotation: 45,\n        visible: false,\n      })\n      const newKeyframePlus = new this.paper.PointText({\n        point: [0, placing - 8],\n        content: '+',\n        fillColor: 'rgba(31, 155, 255, 0.5)',\n        fontSize: 14,\n        visible: false,\n      })\n\n      newKeyframeItems.push([timelineHover, newKeyframeRect, newKeyframePlus])\n\n      // TODO: Put these all in a group, including the playheadsegment, and apply one event\n      const newKeyframeHoverEffect = (event) => {\n        newKeyframeRect.visible = true\n        newKeyframePlus.visible = true\n        newKeyframeRect.position.x = event.point.x\n        newKeyframePlus.position.x = event.point.x + 10\n      }\n      const newKeyframeHide = () => {\n        newKeyframeRect.visible = false\n        newKeyframePlus.visible = false\n      }\n      const newKeyClick = (event) => {\n        const frame = Math.round((event.point.x - timelineStart) / timelineStep)\n        item.addKey(prop, frame)\n        this.rebuild()\n      }\n\n      timelineHover.onMouseMove = newKeyframeHoverEffect\n      timelineHover.onMouseLeave = newKeyframeHide\n      timeline.onMouseMove = newKeyframeHoverEffect\n      timeline.onMouseLeave = newKeyframeHide\n\n      newKeyframeRect.onMouseMove = (event) => {\n        if (timelineHover.hitTest(event.point, { stroke: true, segments: false })) {\n          newKeyframeHoverEffect(event)\n        } else {\n          newKeyframeHide()\n        }\n      }\n\n      timelineHover.onClick = newKeyClick\n      timeline.onClick = newKeyClick\n      newKeyframeRect.onClick = newKeyClick\n\n      // Draw Keyframes\n      list.forEach((keyframe, keyframeIndex) => {\n        const keyframeRect = new this.paper.Path.Rectangle({\n          name: `${item.key}.${prop}.${keyframeIndex}`,\n          point: [timelineStart + keyframe.frame * timelineStep - 5, placing - 10],\n          size: [10, 10],\n          radius: 3,\n          fillColor: 'rgb(30, 155, 255)',\n          rotation: 45,\n          strokeColor: 'white',\n          strokeWidth: 0,\n          shadowColor: 'rgba(0, 0, 0, 0)',\n          shadowBlur: 5,\n        })\n\n        keyframeRect.on('mousedown', this.handleKeyframeClick)\n        keyframeRect.onMouseEnter = () => {\n          this.element.style.cursor = 'pointer'\n          newKeyframeHide()\n        }\n        keyframeRect.onMouseLeave = () => {\n          this.element.style.cursor = 'default'\n        }\n      })\n\n      placementIndex += 1\n    })\n\n    playheadLine.onMouseMove = (event) => {\n      newKeyframeItems.forEach(([\n        timelineHover,\n        newKeyframeRect,\n        newKeyframePlus,\n      ]) => {\n        if (timelineHover.hitTest(event.point)) {\n          /* eslint-disable no-param-reassign */\n          newKeyframeRect.visible = true\n          newKeyframePlus.visible = true\n          newKeyframeRect.position.x = event.point.x\n          newKeyframePlus.position.x = event.point.x + 10\n        } else {\n          newKeyframeRect.visible = false\n          newKeyframePlus.visible = false\n        }\n      })\n    }\n    playheadLine.bringToFront()\n  }\n\n  rebuild() {\n    this.paper.project.clear()\n    this.paper.project.remove()\n    this.buildKeyframeEditorCanvas()\n  }\n\n  buildPlayhead() {\n    const { size, now } = this.props\n    const { timelineStart, timelineStep } = this.timelineMath()\n    const playheadLine = new this.paper.Path.Line({\n      from: [timelineStart + now * timelineStep, 10],\n      to: [timelineStart + now * timelineStep, size.height - 10],\n      strokeColor: 'white',\n      strokeWidth: 1,\n    })\n    const playheadTriangle = new this.paper.Path.RegularPolygon({\n      center: [timelineStart + now * timelineStep, 10],\n      sides: 3,\n      radius: 6,\n      rotation: 180,\n      fillColor: 'white',\n    })\n    return { playheadLine, playheadTriangle }\n  }\n\n  timelineMath() {\n    const { size, frames } = this.props\n    const verticalSpacing = 40\n    const timelineStart = 80\n    const timelineEnd = size.width - verticalSpacing\n    const timelineWidth = timelineEnd - timelineStart\n    const timelineStep = timelineWidth / frames\n    return {\n      verticalSpacing,\n      timelineStart,\n      timelineEnd,\n      timelineWidth,\n      timelineStep,\n    }\n  }\n\n  render() {\n    const { size, item } = this.props\n\n    if (size === undefined || item === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'grey' }}>\n          Select an Item to view its Keyframes.\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <Canvas\n          id=\"keyframe-editor\"\n          width={size.width}\n          height={size.height}\n          hasSize={this.keyframeEditorHasSize}\n        />\n      </div>\n    )\n  }\n}\n\nexport default KeyframeEditor\n","import React, { Component } from 'react'\nimport { autorun } from 'mobx'\nimport { observer } from 'mobx-react'\n\nimport Viewer from './Viewer'\nimport HandleEditor from './HandleEditor'\nimport KeyframeEditor from './KeyframeEditor'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nimport { titleCase } from '../util/string'\n\n@observer\nclass AnimateMode extends Component {\n  state = {\n    heWidth: undefined,\n    keSize: undefined,\n    selectedItemKey: undefined,\n  }\n\n  autorunDisposer\n\n  componentDidMount() {\n    const { canvas } = this.props.store\n    const container = document.getElementById('view-container')\n    setTimeout(() => {\n      const width = Math.round(container.clientWidth) - 20\n      const height = Math.round((9 / 16) * width)\n      canvas.setSize(width, height)\n    }, 1)\n\n    const container2 = document.getElementById('handle-container')\n    setTimeout(() => {\n      const width = Math.round(container2.clientWidth) - 20\n      const height = Math.round(container2.clientHeight) - 20\n      const smallestLength = Math.min(width, height)\n      this.setState({ heWidth: smallestLength })\n    }, 1)\n\n    const container3 = document.getElementById('keyframe-container')\n    setTimeout(() => {\n      const width = Math.round(container3.clientWidth) - 20\n      const height = Math.round(container3.clientHeight) - 20\n      this.setState({ keSize: { width, height } })\n    }, 1)\n\n    this.autorunDisposer = autorun(() => {\n      if (canvas.selected) {\n        this.setState({ selectedItemKey: canvas.selected.key })\n      } else {\n        this.setState({ selectedItemKey: undefined })\n      }\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { tools } = this.props.store\n    if (prevState.selectedItemKey !== this.state.selectedItemKey) {\n      tools.selectKeyframe(undefined)\n    }\n  }\n\n  componentWillUnmount() {\n    const { canvas, project, tools } = this.props.store\n    canvas.selectOff()\n    project.clear()\n    tools.selectKeyframe(undefined)\n    this.autorunDisposer()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n    setTimeout(() => {\n      canvas.setTool(undefined)\n      canvas.setTool('SELECT')\n    }, 20)\n  }\n\n  changeHandlePosition = (handleType, { influence, distance }) => {\n    const { tools, canvas } = this.props.store\n    if (!tools.selectedKeyframe) return\n\n    const handleSuffix = titleCase(handleType)\n    const [kItem, kProp, kIndexStr] = tools.selectedKeyframe.split('.')\n    let kIndex = parseInt(kIndexStr)\n    if (handleType === 'IN') {\n      kIndex += 1\n    }\n\n    const targetHandle = canvas.animatables[kItem].keyframes[kProp][kIndex][`handle${handleSuffix}`]\n    let auxilaryHandle\n    if (kProp === 'x') {\n      auxilaryHandle = canvas.animatables[kItem].keyframes.y[kIndex][`handle${handleSuffix}`]\n    }\n\n    targetHandle.influence += influence\n    targetHandle.distance += distance\n\n    if (auxilaryHandle) {\n      auxilaryHandle.influence += influence\n      auxilaryHandle.distance += distance\n    }\n  }\n\n  render() {\n    const { canvas, animation, tools } = this.props.store\n    const { heWidth, keSize } = this.state\n\n    let keyframeBefore\n    let keyframeAfter\n    if (tools.selectedKeyframe) {\n      const [kItem, kProp, kIndexStr] = tools.selectedKeyframe.split('.')\n      const kIndex = parseInt(kIndexStr)\n      const keyframesOfType = canvas.animatables[kItem].keyframes[kProp]\n      keyframeBefore = keyframesOfType[kIndex]\n      if (kIndex + 1 < keyframesOfType.length) {\n        keyframeAfter = keyframesOfType[kIndex + 1]\n      }\n    }\n\n    return (\n      <Grid\n        gridTemplateRows=\"auto 340px\"\n        gridTemplateColumns=\"auto 400px\"\n      >\n        <GridItem id=\"view-container\" padding=\"10px\" gridArea=\"1 / 1 / 1 / 2\">\n          <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n        </GridItem>\n        <GridItem id=\"handle-container\" gridArea=\"1 / 2 / 1 / 3\" backgroundColor=\"rgb(210, 210, 210)\">\n          <HandleEditor\n            width={heWidth}\n            keyframeKey={tools.selectedKeyframe}\n            keyframeBefore={keyframeBefore}\n            keyframeAfter={keyframeAfter}\n            onMove={this.changeHandlePosition}\n          />\n        </GridItem>\n        <GridItem id=\"keyframe-container\" gridArea=\"2 / 1 / 2 / 3\" backgroundColor=\"rgb(180, 180, 180)\">\n          <KeyframeEditor\n            size={keSize}\n            item={canvas.selected}\n            keyframeKey={tools.selectedKeyframe}\n            keyframe={keyframeBefore}\n            onSelect={tools.selectKeyframe}\n            frames={animation.frames}\n            now={animation.now}\n          />\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default AnimateMode\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\n@observer\nclass PlayController extends Component {\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeyDown, false)\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown, false)\n  }\n\n  handleKeyDown = (event) => {\n    const {\n      play,\n      pause,\n      goToNext,\n      goToPrev,\n      goToFirst,\n      goToLast,\n      playing,\n    } = this.props.animation\n    const { key, shiftKey } = event\n\n    if (key === 'ArrowLeft' && shiftKey) {\n      goToFirst()\n    } else if (key === 'ArrowLeft') {\n      goToPrev()\n    } else if (key === 'ArrowRight' && shiftKey) {\n      goToLast()\n    } else if (key === 'ArrowRight') {\n      goToNext()\n    } else if (key === ' ') {\n      event.stopPropagation()\n      event.preventDefault()\n      if (playing === true) {\n        pause()\n      } else {\n        play()\n      }\n    }\n  }\n\n  render() {\n    const {\n      play,\n      pause,\n      goToNext,\n      goToPrev,\n      goToFirst,\n      goToLast,\n      playing,\n    } = this.props.animation\n\n    return (\n      <Grid gridTemplateColumns=\"30% 1fr 1fr 1fr 1fr 1fr 30%\" height=\"60px\" alignItems=\"center\" justifyItems=\"center\" borderTop=\"1px solid rgb(230, 230, 230)\">\n        <GridItem gridColumnStart=\"2\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToFirst}>&#8676;</button>\n        </GridItem>\n        <GridItem gridColumnStart=\"3\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToPrev}>&#9667;</button>\n        </GridItem>\n        <GridItem gridColumnStart=\"4\">\n          { playing === false ?\n            <button type=\"button\" style={{ margin: 0 }} onClick={play}>&#9658;</button> :\n            <button type=\"button\" style={{ margin: 0 }} onClick={pause}>&#10073; &#10073;</button>\n          }\n        </GridItem>\n        <GridItem gridColumnStart=\"5\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToNext}>\n            <div style={{ transform: 'rotate(180deg)' }}>&#9667;</div>\n          </button>\n        </GridItem>\n        <GridItem gridColumnStart=\"6\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToLast}>&#8677;</button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default PlayController\n","import React from 'react'\n\nconst getWidth = () => (\n  window.innerWidth\n    || document.documentElement.clientWidth\n    || document.body.clientWidth\n)\n\nconst getHeight = () => (\n  window.innerHeight\n    || document.documentElement.clientHeight\n    || document.body.clientHeight\n)\n\nconst withWindowSize = Component => (\n  class extends React.Component {\n    state = {\n      width: getWidth(),\n      height: getHeight(),\n    }\n\n    componentDidMount() {\n      window.addEventListener('resize', this.updateDimensions)\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('resize', this.updateDimensions)\n    }\n\n    updateDimensions = () => {\n      const width = getWidth()\n      const height = getHeight()\n      this.setState({ width, height })\n    }\n\n    render() {\n      const { width, height } = this.state\n      return <Component width={width} height={height} {...this.props} />\n    }\n  }\n)\n\nexport default withWindowSize\nexport {\n  getWidth,\n  getHeight,\n}\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Viewer from './Viewer'\nimport PlayController from './PlayController'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\nimport { getWidth } from '../components/withWindowSize'\n\n@observer\nclass ViewMode extends Component {\n  componentDidMount() {\n    const { canvas } = this.props.store\n    const width = getWidth() - 20\n    const height = Math.round((9 / 16) * width)\n    canvas.setSize(width, height)\n  }\n\n  componentWillUnmount() {\n    const { project } = this.props.store\n    project.clear()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n  }\n\n  render() {\n    const { canvas, animation } = this.props.store\n    return (\n      <Grid\n        gridTemplateRows=\"auto 60px\"\n        alignItems=\"center\"\n      >\n        <GridItem padding=\"10px\">\n          <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n        </GridItem>\n        <PlayController animation={animation} />\n      </Grid>\n    )\n  }\n}\n\nexport default ViewMode\n","var map = {\n\t\"./bare.min.css\": \"v4a6\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"zGb5\";"],"sourceRoot":""}